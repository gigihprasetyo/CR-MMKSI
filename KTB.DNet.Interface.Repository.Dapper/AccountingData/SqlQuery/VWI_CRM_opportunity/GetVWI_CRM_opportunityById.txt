SELECT 
	ROW_NUMBER() OVER (ORDER BY (Select 0) ) AS IDRow
	,businessunitcode
	,xjp_benefitforrepairabledamagename
	,xts_insurancegrade
	,xts_vehicleincidentalcategoryname
	,ktb_isinterfacedname
	,statuscode
	,captureproposalfeedback
	,ktb_dnetid
	,developproposal
	,contactidname
	,xts_agencychannelidname
	,description
	,salesstagename
	,evaluatefit
	,parentaccountidname
	,xts_periodofinsurancelabel
	,xts_vehicledrivinglicensetypename
	,xts_chasisnumber
	,xts_lastcontractidname
	,xts_address3
	,estimatedvalue_base
	,xts_configurationid
	,xts_vehiclemodelidname
	,xjp_repurchasenewvehicle
	,xts_propertydamageliabilitycompensationamount_base
	,scheduleproposalmeeting
	,actualvalue
	,xts_propertydamageliabilityunlimitedcoveragename
	,contactid
	,importsequencenumber
	,statecodename
	,xts_potentialcustomernumber
	,xts_countryidname
	,lastonholdtime
	,totaltax
	,customeridname
	,opportunityid
	,xjp_firstdeductible
	,purchasetimeframe
	,xts_vehicledrivinglicensetypeidname
	,xts_birthday
	,ktb_statusinterfacename
	,xts_vehiclebrandid
	,xts_villageandstreetidname
	,xjp_passengerscoverageamount_base
	,accountidyominame
	,xts_defaultprice_base
	,parentaccountid
	,slainvokedidname
	,ktb_vehiclemodelid
	,owningbusinessunit
	,completeinternalreviewname
	,salesstagecode
	,prioritycodename
	,xts_categoryid
	,xts_driverlimitationcategoryname
	,slaname
	,xts_vehicleincidentcategoryid
	,xts_styleid
	,xts_insurednameidyominame
	,xts_styleidname
	,xts_vehicleidentificationidname
	,skippricecalculationname
	,versionnumber
	,initialcommunication
	,xjp_benefitforrepairabledamage
	,xjp_temporaryloanercar
	,xts_exteriorcolorid
	,customeridtype
	,xjp_platenumbersegment3
	,xjp_bodilyinjurycompensationforonlypassengersname
	,xts_chasismodel
	,createdbyyominame
	,identifypursuitteamname
	,xts_insurednameid
	,initialcommunicationname
	,accountidname
	,originatingleadidname
	,needname
	,xts_manufactureridname
	,xjp_vehicleinspectionexpirationdate
	,xjp_legalfeename
	,xts_whileintheinsuredvehicleonlycoverage
	,xts_cityid
	,totallineitemdiscountamount_base
	,xts_relatedperiodeofinsuranceid
	,xts_propertydamageliabilitycompensationamount
	,currentsituation
	,resolvefeedbackname
	,identifycustomercontacts
	,ktb_eventdata
	,totaltax_base
	,ktb_interfaceexceptionmessage
	,xts_gender
	,presentfinalproposal
	,transactioncurrencyidname
	,xts_categoryidname
	,discountamount
	,xts_personinchargeid
	,ktb_spkid
	,filedebriefname
	,ktb_tempdocument
	,createdonbehalfbyname
	,pricingerrorcodename
	,totaldiscountamount
	,xts_parentbusinessunitid
	,xts_sourceinformationidname
	,xts_insurancepaymentmethodid
	,xts_vehicleidentificationid
	,xts_personinchargeidname
	,transactioncurrencyid
	,xts_salesobjectivename
	,freightamount_base
	,xts_manufacturerid
	,owneridname
	,xts_vehiclename
	,customeridyominame
	,ktb_vehiclemodelidname
	,xts_vehicleincidentcategoryidname
	,xts_potentialcontactidname
	,originatingleadidyominame
	,campaignidname
	,decisionmakername
	,parentcontactidname
	,xts_driverlimitationcategory
	,opportunityratingcodename
	,traversedpath
	,exchangerate
	,ktb_isinterfaced
	,xts_statusreasonidname
	,xts_relatedexpirationdate
	,xts_interiorcoloridname
	,xts_vehiclebrandidname
	,pricelevelid
	,xts_agencychannelid
	,xts_policynumber
	,presentproposal
	,sendthankyounote
	,confirminterest
	,xjp_bodilyinjurycompensation_base
	,purchasetimeframename
	,skippricecalculation
	,xts_vehicledrivinglicensetypevalue
	,xjp_platenumbersegment1idname
	,pursuitdecisionname
	,xts_bodilyinjuryliabilitycompensationamount
	,xts_whileintheinsuredvehicleonlycoveragename
	,isrevenuesystemcalculated
	,pursuitdecision
	,xto_quantity
	,xjp_platenumbersegment4
	,identifycustomercontactsname
	,createdon
	,slaid
	,originatingleadid
	,xjp_firstregistration
	,xts_proposeinsurancecompanyname
	,xts_relatedperiodeofinsuranceidname
	,xts_proposedinsurancecompanyid
	,schedulefollowup_qualify
	,presentfinalproposalname
	,totalamount
	,xts_periodofinsurancevalue
	,xjp_disastertotallossspecialagreement
	,xts_periodofinsurance
	,quotecomments
	,xts_vehiclemodelid
	,budgettypename
	,xts_insuredname
	,xts_locking
	,schedulefollowup_prospect
	,budgetstatus
	,xjp_bodilyinjurycompensationforonlypassengers
	,createdbyname
	,xts_productidname
	,statecode
	,xts_periodofinsurancename
	,closeprobability
	,totalamount_base
	,ktb_vehicledescription
	,xjp_gradeprotection
	,opportunityratingcode
	,purchaseprocessname
	,xts_vehicledrivinglicensetypelabel
	,participatesinworkflowname
	,xts_insurancepaymentmethodidname
	,overriddencreatedon
	,xts_productid
	,proposedsolution
	,resolvefeedback
	,modifiedonbehalfbyyominame
	,xts_phonenumber
	,ktb_statusinterface
	,developproposalname
	,statuscodename
	,owninguser
	,decisionmaker
	,ktb_progressstagename
	,xts_parentbusinessunitidname
	,modifiedbyname
	,xjp_platenumbersegment2
	,owneridtype
	,slainvokedid
	,ktb_spkidname
	,xts_businessunitid
	,ktb_occuationname
	,completefinalproposalname
	,xjp_bodilyinjurycompensation
	,participatesinworkflow
	,xts_exteriorcoloridname
	,estimatedclosedate
	,prioritycode
	,xts_salesobjective
	,xts_propertydamageliabilityunlimitedcoverage
	,xts_insurancecompanyid
	,xts_potentialcontactidyominame
	,xto_discount
	,purchaseprocess
	,xts_insurancecarusagepurposename
	,msdyn_forecastcategory
	,pricelevelidname
	,xts_vehicledrivinglicensetype
	,estimatedvalue
	,xjp_temporaryloanercarname
	,onholdtime
	,xts_apppointmentidname
	,timezoneruleversionnumber
	,createdonbehalfbyyominame
	,xts_provinceidname
	,xts_insuranceannualpremium_base
	,emailaddress
	,need
	,isprivatename
	,contactidyominame
	,ownerid
	,salesstagecodename
	,campaignid
	,parentcontactid
	,totallineitemdiscountamount
	,modifiedonbehalfby
	,xjp_firstdeductible_base
	,owningteam
	,xts_vehicleincidentalcategory
	,xts_address4
	,xjp_personalliabilityname
	,xts_countryid
	,xts_agelimiteddriver
	,xts_apppointmentid
	,xts_vehiclevalue_base
	,isprivate
	,xts_address1
	,confirminterestname
	,budgetamount_base
	,modifiedbyyominame
	,xts_insurancecompanyname
	,xts_gendername
	,xts_cityidname
	,owneridyominame
	,ktb_progressstage
	,xts_statusreasonid
	,xjp_personalliability
	,completefinalproposal
	,customerneed
	,ktb_vehiclecategoryidname
	,parentcontactidyominame
	,xjp_repurchasenewvehiclename
	,ktb_vehiclecolorname
	,xts_salespersonid
	,xts_insurancecarusagepurpose
	,isrevenuesystemcalculatedname
	,identifycompetitorsname
	,captureproposalfeedbackname
	,customerid
	,xjp_disastertotallossspecialagreementname
	,xts_villageandstreetid
	,stageid
	,modifiedonbehalfbyname
	,ktb_occuation
	,modifiedby
	,identifycompetitors
	,teamsfollowed
	,totallineitemamount
	,xts_defaultprice
	,xjp_gradeprotectionname
	,xts_baseprice_base
	,xts_postalcode
	,evaluatefitname
	,timespentbymeonemailandmeetings
	,totaldiscountamount_base
	,salesstage
	,sendthankyounotename
	,xts_configurationidname
	,customerpainpoints
	,finaldecisiondate
	,xts_insurancecompanyidname
	,xts_baseprice
	,parentaccountidyominame
	,timeline
	,xts_insuranceannualpremium
	,stepname
	,xts_bodilyinjuryliabilityunlimitedcoverage
	,xto_discount_base
	,name
	,utcconversiontimezonecode
	,totalamountlessfreight
	,xts_salespersonidname
	,xts_address2
	,timelinename
	,ktb_vehiclecategoryid
	,discountamount_base
	,stepid
	,xts_provinceid
	,xjp_seconddeductible_base
	,totalamountlessfreight_base
	,discountpercentage
	,xts_vehiclevalue
	,xts_leaddate
	,xjp_seconddeductible
	,pricingerrorcode
	,xts_sourceinformationid
	,actualclosedate
	,totallineitemamount_base
	,processid
	,modifiedon
	,accountid
	,xts_businessunitidname
	,xts_vehicledrivinglicensetypeid
	,qualificationcomments
	,xjp_passengerscoverageamount
	,identifypursuitteam
	,xts_interiorcolorid
	,xts_proposedinsurancecompanyidname
	,createdonbehalfby
	,presentproposalname
	,ktb_lostreason
	,actualvalue_base
	,xts_lastcontractid
	,filedebrief
	,xts_potentialcontactid
	,xjp_platenumbersegment1id
	,budgetamount
	,ktb_tempdocumentname
	,createdby
	,xts_bodilyinjuryliabilitycompensationamount_base
	,msdyn_forecastcategoryname
	,freightamount
	,completeinternalreview
	,xts_bodilyinjuryliabilityunlimitedcoveragename
	,xts_insurednameidname
	,xjp_legalfee
	,RowStatus
from (
	SELECT      
		b.ktb_bucompany company    
		, b.ktb_dealercode businessunitcode    
		, a.*  
		, b.msdyn_companycode    
	FROM CRM_opportunity a  WITH(NOLOCK)   
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
	ON B.businessunitid = a.xts_businessunitid 
	WHERE opportunityid = @Id
) VWI_CRM_opportunity
