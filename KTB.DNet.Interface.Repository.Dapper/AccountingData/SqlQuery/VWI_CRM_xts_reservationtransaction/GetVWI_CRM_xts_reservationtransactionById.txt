SELECT 
	ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	,businessunitcode
	,xts_reservationtransaction
	,ktb_esttotalworktaxamount
	,modifiedon
	,overriddencreatedon
	,xts_finishpattern
	,ktb_esttotalmiscchargebaseamount_base
	,statuscodename
	,xts_status
	,xts_scheduledarrivaldateandtime
	,xts_deliveryaddress2
	,xts_workorderidname
	,xts_estimatebayidname
	,ktb_esttotalbaseamount_base
	,ktb_esttotalothersalestaxamount_base
	,ktb_esttotalothersalestaxamount
	,xts_pickupaddress1
	,ktb_estgrandtotalamount
	,transactioncurrencyidname
	,xts_customeridyominame
	,xts_chassismodel
	,xts_vehicleincludedintherecall
	,createdonbehalfby
	,xts_scheduledservicestartdate
	,xts_pickupaddress2
	,ktb_productsegment2id
	,ktb_productsegment4idname
	,ktb_esttotalworkamount_base
	,owningbusinessunit
	,ktb_productidname
	,xts_deliverypostalcode
	,xts_customernumber
	,ktb_productsegment3idname
	,ktb_exchangerateamount
	,modifiedonbehalfby
	,xts_customeridname
	,owneridyominame
	,statuscode
	,xts_estimatebayid
	,ktb_esttotalmiscchargeamount_base
	,ktb_esttotalothersalesbaseamount
	,xts_defaultoutsourceworkshopidname
	,xts_maintenancepackageinformation
	,ktb_esttotalworkamount
	,statecodename
	,xts_deliveryaddress1
	,xts_scheduledfinishdateandtime
	,ktb_esttotalmiscchargetaxamount
	,ktb_productsegment1idname
	,xts_contactpersonidname
	,xts_vehicleidentificationid
	,xts_contactpersonid
	,xts_reservationpersoninchargeid
	,xts_defaultoutsourceworkshopid
	,xts_servicecategoryid
	,createdon
	,ktb_productsegment2idname
	,xts_handling
	,xts_customerid
	,xts_statusname
	,ktb_esttotalmiscchargeamount
	,xts_contactpersonidyominame
	,xts_previousreservationid
	,ktb_esttotalworkbaseamount_base
	,ktb_productdescription
	,xts_vehicleidentificationidname
	,ktb_esttotaltaxamount_base
	,xts_personinchargefordeliveryidname
	,modifiedby
	,timezoneruleversionnumber
	,ktb_esttotalothersalesbaseamount_base
	,owninguser
	,xts_incomingoutsourcebusinessunitid
	,xts_vehicleplatenumber
	,xts_vehiclemodelname
	,ktb_esttotalworkbaseamount
	,ktb_exchangerate
	,ktb_exchangeratedate
	,xts_globalserviceidname
	,traversedpath
	,xts_aliasname
	,ktb_esttotalpartstaxamount
	,createdonbehalfbyname
	,xts_reservationclassidname
	,ktb_esttotaltaxamount
	,xts_servicecategoryidname
	,xts_reservationclassid
	,xts_salespersonid
	,owneridtype
	,ktb_esttotalpartsamount_base
	,xts_transactiondate
	,ktb_esttotalpartstaxamount_base
	,xts_personinchargeforarrivalidname
	,xts_reservationtransactionid
	,xts_chassisnumber
	,owneridname
	,xts_vehicleincludedintherecallname
	,modifiedonbehalfbyname
	,createdonbehalfbyyominame
	,xts_personinchargeforarrivalid
	,xts_loadinggroupidname
	,ktb_dnetticketno
	,xts_globalserviceid
	,owningteam
	,xts_reservationmemo
	,ktb_productsegment4id
	,xts_arrivalpatternname
	,xts_parentbusinessunitidname
	,processid
	,exchangerate
	,xts_insurancecontract
	,xts_parentbusinessunitid
	,transactioncurrencyid
	,xts_reservationpersoninchargeidname
	,xts_finishpatternname
	,modifiedbyyominame
	,ownerid
	,ktb_esttotalpartsamount
	,xts_ordertypeidname
	,xts_salespersonidname
	,createdbyname
	,xts_businessunitidname
	,statecode
	,xts_personinchargefordeliveryid
	,modifiedonbehalfbyyominame
	,createdby
	,xts_platenumber
	,xts_arrivalpattern
	,ktb_productsegment1id
	,xts_deliveryaddress4
	,xts_ordertypeid
	,xts_arrivalpostalcode
	,xts_deliveryaddress3
	,stageid
	,utcconversiontimezonecode
	,xts_incomingoutsourcebusinessunitidname
	,ktb_esttotalothersalesamount_base
	,ktb_estgrandtotalamount_base
	,importsequencenumber
	,xts_locking
	,ktb_productid
	,xts_reservationmanhour
	,xts_pickupaddress3
	,xts_servicepackagecontract
	,versionnumber
	,ktb_esttotalothersalesamount
	,xts_businessunitid
	,ktb_esttotalbaseamount
	,ktb_esttotalworktaxamount_base
	,ktb_esttotalpartsbaseamount_base
	,xts_handlingname
	,ktb_esttotalpartsbaseamount
	,ktb_esttotalmiscchargetaxamount_base
	,xts_pickupaddress4
	,xts_contactpersonphone
	,modifiedbyname
	,ktb_productsegment3id
	,createdbyyominame
	,ktb_esttotalmiscchargebaseamount
	,xts_loadinggroupid
	,xts_previousreservationidname
	,xts_workorderid
	,RowStatus
FROM (
	SELECT  
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.* 
        , b.msdyn_companycode
    FROM CRM_xts_reservationtransaction a WITH(NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.owningbusinessunit
    WHERE xts_reservationtransactionid = @Id
) VWI_CRM_xts_reservationtransaction 
