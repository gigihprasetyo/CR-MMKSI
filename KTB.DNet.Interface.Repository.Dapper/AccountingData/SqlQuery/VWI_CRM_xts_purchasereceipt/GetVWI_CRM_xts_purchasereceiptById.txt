SELECT 
	ROW_NUMBER() OVER (ORDER BY (Select 0) ) AS IDRow
	,company
	,businessunitcode
	,xts_vendordescription
	,xts_parentbusinessunitid
	,versionnumber
	,createdon
	,ktb_updatetosparepartstock
	,ktb_purchaserequisitionid
	,ktb_isfactoringname
	,xts_provinceid
	,ktb_packingdate
	,statuscodename
	,xts_status
	,xts_vendorinvoicedate
	,modifiedbyyominame
	,ktb_interfacehandling
	,owneridtype
	,xts_vendorinvoicenumber
	,ktb_identificationtypename
	,xts_totalbaseamount_base
	,xts_termsofpaymentid
	,xts_autoinvoiced
	,xts_loaddataname
	,modifiedbyname
	,xts_totalwithholdingtaxamount
	,xts_accountpayablevoucheridname
	,ktb_interfacestatusname
	,xts_purchasereceiptreferencerequired
	,owneridname
	,xts_provinceidname
	,xts_assignlandedcostperdetail
	,overriddencreatedon
	,xts_typename
	,xts_address2
	,xts_type
	,xts_eventdata
	,modifiedonbehalfby
	,exchangerate
	,xts_totalconsumptiontaxamount_base
	,xts_address4
	,xts_returnpurchasereceiptid
	,owningteam
	,xts_totalbaseamount
	,statecode
	,xts_totalwithholdingtaxamount_base
	,ktb_updatetosparepartstockname
	,xts_termsofpaymentidname
	,timezoneruleversionnumber
	,xts_accountpayablevoucherid
	,xts_deliveryorderdate
	,ktb_paymentdate
	,ktb_goodissuedate
	,ktb_ata
	,xts_loaddata
	,xts_totalconsumptiontaxamount
	,xts_locking
	,xts_purchasereceiptnumber
	,ktb_salesorderno
	,ktb_pickingdate
	,xts_assignlandedcostperdetailname
	,xts_totaltitleregistrationfee_base
	,xts_countryid
	,ktb_duedate
	,xts_returnpurchasereceiptidname
	,traversedpath
	,createdonbehalfbyname
	,xts_handling
	,xts_cityid
	,createdonbehalfby
	,xts_autoinvoicedname
	,utcconversiontimezonecode
	,xts_deliveryordernumber
	,xts_statusname
	,xts_totaltitleregistrationfee
	,ownerid
	,modifiedon
	,importsequencenumber
	,owneridyominame
	,xts_workorderidname
	,xts_countryidname
	,xts_transferorderrequestingid
	,xts_totalconsumptiontax1amount
	,xts_transactiondate
	,ktb_isfactoring
	,xts_purchaseorderidname
	,xts_workorderid
	,xts_eventdata2
	,createdbyname
	,ktb_interfacestatus
	,xts_businessunitid
	,ktb_deliveryfordeliverydate
	,modifiedonbehalfbyname
	,xts_address3
	,ktb_invoicedate
	,ktb_estimationdeliverydate
	,xts_cityidname
	,xts_purchasereceiptid
	,xts_bigdata
	,ktb_ribbondataproductwarehouse
	,processid
	,xts_handlingname
	,xts_grandtotal
	,xts_grandtotal_base
	,xts_postalcode
	,transactioncurrencyid
	,xts_packingslipdate
	,xts_businessunitidname
	,createdby
	,ktb_isinterfaced
	,modifiedby
	,xts_address1
	,ktb_ribbondata
	,stageid
	,xts_parentbusinessunitidname
	,ktb_identificationtype
	,createdbyyominame
	,owninguser
	,transactioncurrencyidname
	,createdonbehalfbyyominame
	,ktb_prpotypeid
	,owningbusinessunit
	,xts_packingslipnumber
	,xts_purchaseorderid
	,ktb_purchaserequisitionidname
	,ktb_isinterfacedname
	,xts_totalconsumptiontax2amount
	,ktb_interfacehandlingname
	,xts_vendorid
	,xts_bigdataname
	,ktb_expeditionnumber
	,statuscode
	,modifiedonbehalfbyyominame
	,ktb_conversiondays
	,xts_purchasereceiptreferencerequiredname
	,xts_totalconsumptiontax2amount_base
	,ktb_discountpercentage
	,xts_transferorderrequestingidname
	,ktb_returnreason
	,ktb_prpotypeidname
	,statecodename
	,xts_totalconsumptiontax1amount_base
	,xts_vendoridname
	,RowStatus
	,ktb_eta
	,ktb_atd
	,ktb_kondisikendaraan
	,ktb_endpoint
	,msdyn_companycode
from (
	SELECT      
		b.ktb_bucompany company    
		, b.ktb_dealercode businessunitcode    
		, a.*  
		, b.msdyn_companycode    
	FROM CRM_xts_purchasereceipt a  WITH(NOLOCK)   
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
	ON B.businessunitid = a.xts_businessunitid 
	WHERE xts_purchasereceiptid = @Id
) VWI_CRM_xts_purchasereceipt
