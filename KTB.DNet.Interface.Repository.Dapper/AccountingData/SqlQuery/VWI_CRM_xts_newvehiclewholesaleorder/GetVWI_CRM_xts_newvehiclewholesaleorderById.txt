SELECT 
	ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	,company
	,businessunitcode
	,ktb_benefitidname
	,traversedpath
	,xts_vehicleamount_base
	,ktb_cbu_purcstat
	,ktb_karoseriidname
	,xts_vehiclerelatedproductamount_base
	,ktb_rejectedreasonoptionname
	,modifiedon
	,xts_accessoriesamount_base
	,overriddencreatedon
	,xjp_tradeinrecyclingamount
	,statuscodename
	,xts_potentiallookupname
	,ktb_rejectedreason
	,ktb_begbal
	,xts_netamountaftertax_base
	,ktb_cbu_purcstat2name
	,xts_handling
	,xts_netamount
	,xts_netamount_base
	,xts_totalreceipt
	,xts_othertaxamount_base
	,ktb_cbu_userage1name
	,transactioncurrencyidname
	,ktb_statusinterfacednetname
	,ktb_nvsoregistrationdetailnumberidname
	,xts_dealerdiscount
	,xts_voluntaryinsuranceamount_base
	,xjp_billtoidname
	,xts_balance_base
	,ktb_qty
	,ktb_cbu_purpose2name
	,owningbusinessunit
	,ktb_productidname
	,ktb_statusinterfacednet
	,xts_addressidname
	,xts_potentialcustomerdescription
	,ktb_campaignid
	,xts_referralamount
	,ktb_categorycode
	,ktb_interfaceexceptionmessage
	,statuscode
	,xts_downpaymentamount_base
	,xts_totalreceipt_base
	,xts_nontaxablemiscellaneouschargeamount_base
	,ktb_namakonsumenspkid
	,ktb_cbu_modelkend
	,ktb_cbu_bodytype1name
	,xts_address3
	,versionnumber
	,ktb_namakonsumenspkidyominame
	,xts_downpaymentamountreceived_base
	,statecodename
	,xts_taxablemiscellaneouschargeamount_base
	,ktb_lkppno
	,ktb_address4
	,xts_couponamount
	,ktb_cbu_purpose1name
	,exchangerate
	,xts_opportunityidname
	,ktb_cbu_jeniskend
	,ktb_cbu_medanoperasi1name
	,xts_compulsoryinsuranceamount_base
	,xts_accessoriesdiscountamount_base
	,xts_taxablemiscellaneouschargeamount
	,ktb_productexteriorcolorid
	,xts_newvehiclewholesaleorderid
	,ktb_begbalname
	,xjp_billtoidyominame
	,ktb_cbu_medanoperasi1
	,xts_potentialcustomeridname
	,ktb_dnetid
	,owneridname
	,createdon
	,xjp_billtoid
	,xts_compulsoryinsuranceamount
	,xts_referralamount_base
	,xts_statusname
	,ktb_nvsoregistrationdetailnumberid
	,ktb_dnetspknumber
	,ktb_cbu_bodytypelcv1
	,ktb_campaignidname
	,xts_othertaxamount
	,ktb_leasingcompanyid
	,xts_vehicleamount
	,xts_tradeinamount_base
	,ktb_cbu_purpose1
	,ktb_cbu_userage1
	,owneridyominame
	,ktb_remarks
	,xts_voluntaryinsuranceamount
	,modifiedby
	,timezoneruleversionnumber
	,ktb_cbu_purpose2
	,xts_zipcode
	,xts_address1
	,ktb_cbu_purcstatname
	,modifiedonbehalfby
	,xts_potentialcustomerid
	,xts_newvehiclewholesaleordernumber
	,ktb_scheduleddeliverydate
	,xts_customernumber
	,ktb_spkdnetreference
	,xts_termofpaymentid
	,xts_outstandingamount_base
	,xjp_tradeinrecyclingamount_base
	,ktb_cbu_jeniskendname
	,createdonbehalfbyname
	,owninguser
	,xts_totalpriceamount
	,ktb_rejectedreasonoption
	,xts_nontaxablemiscellaneouschargeamount
	,ktb_karoseriid
	,xts_salespersonid
	,owneridtype
	,xts_transactiondate
	,ktb_additional
	,xts_couponamount_base
	,xts_vehiclediscountamount
	,modifiedonbehalfbyname
	,createdonbehalfbyyominame
	,ktb_isinterfaced
	,ktb_handlingname
	,xts_subsidizeddiscount
	,ktb_cbu_bodytypelcv1name
	,xts_potentiallookuptype
	,owningteam
	,xts_accessoriesdiscountamount
	,xts_opportunityid
	,xjp_billtonumber
	,ktb_dnetspkcustomerid
	,xts_downpaymentamountreceived
	,xts_downpaymentamountispaidname
	,xts_parentbusinessunitidname
	,xts_bookingfeeamount_base
	,processid
	,xts_balance
	,xjp_recyclingamount
	,createdonbehalfby
	,ktb_cbu_ownership1
	,ktb_namakonsumenspkidname
	,xts_parentbusinessunitid
	,ktb_cbu_purcstat2
	,transactioncurrencyid
	,ktb_statusname
	,xts_dealerdiscount_base
	,xjp_recyclingamount_base
	,ktb_isinterfacedname
	,xts_addressid
	,modifiedbyyominame
	,ownerid
	,xts_consumptiontaxtotalamount
	,xts_netamountaftertax
	,ktb_dnetsapcustomerid
	,xts_bookingfeeamount
	,ktb_cbu_loadprofile1name
	,ktb_categorycodename
	,xts_titleregistrationfee
	,xts_consumptiontaxtotalamount_base
	,xts_salespersonidname
	,xts_vehiclerelatedproductamount
	,ktb_benefitid
	,createdbyname
	,ktb_dnetspkdetailid
	,xts_businessunitidname
	,xts_outstandingamount
	,xts_phonenumber
	,xts_accessoriesamount
	,modifiedonbehalfbyyominame
	,createdby
	,ktb_namakonsumenspk
	,ktb_cbu_loadprofile1
	,xts_specialcolorpriceamount_base
	,ktb_cbu_waypaid1
	,ktb_cbu_bodytype1
	,ktb_leasingcompanyidname
	,ktb_cbu_modelkendname
	,stageid
	,utcconversiontimezonecode
	,xts_subsidizeddiscount_base
	,ktb_handling
	,xts_potentialcustomeridyominame
	,ktb_tempdocument
	,importsequencenumber
	,xts_locking
	,ktb_productid
	,xts_address2
	,xts_businessunitid
	,ktb_additionalname
	,ktb_cbu_waypaid1name
	,xts_titleregistrationfee_base
	,xts_handlingname
	,xts_potentialcontactidname
	,ktb_status
	,xts_status
	,xts_vehiclediscountamount_base
	,modifiedbyname
	,createdbyyominame
	,xts_specialcolorpriceamount
	,xts_vehiclediscountpercentage
	,xts_potentialcontactid
	,xts_downpaymentamount
	,xts_termofpaymentidname
	,ktb_tempdocumentname
	,xts_potentialcontactidyominame
	,ktb_productexteriorcoloridname
	,ktb_cbu_ownership1name
	,xts_downpaymentamountispaid
	,xts_tradeinamount
	,xts_totalpriceamount_base
	,statecode
	,RowStatus
	,ktb_externalcode
	,msdyn_companycode
FROM (
	SELECT  
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.*
        , b.msdyn_companycode
    FROM CRM_xts_newvehiclewholesaleorder a WITH(NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
    WHERE xts_newvehiclewholesaleorderid = @Id
) VWI_CRM_xts_newvehiclewholesaleorder
