SELECT   
	ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	,businessunitcode
	,ktb_isinterfacedname
	,xjp_customernumber
	,versionnumber
	,xjp_actualcost_base
	,xjp_stockidname
	,xjp_pdistatusname
	,xjp_productid
	,statuscodename
	,xjp_parentbusinessunitidname
	,xjp_arrivaldate
	,modifiedon
	,createdon
	,owneridtype
	,xjp_deliverybusinessunitidname
	,xjp_autoreceipt
	,createdonbehalfby
	,xjp_handlingname
	,modifiedbyname
	,xjp_vendoridname
	,xjp_departmentid
	,xjp_exteriorcolorid
	,xjp_styleidname
	,xjp_productidname
	,xjp_parentbusinessunitid
	,owneridname
	,xjp_vehiclesuggestedarrivaldateandtime
	,overriddencreatedon
	,xjp_desireddeliverydate
	,xjp_actualcost
	,xjp_pdicategory
	,xjp_customeridname
	,createdonbehalfbyyominame
	,modifiedonbehalfby
	,exchangerate
	,xjp_vendorid
	,xjp_pdistatus
	,xjp_newvehiclesalesorderid
	,xjp_costdifference_base
	,owningteam
	,xjp_interiorcolorid
	,statecode
	,ktb_iskaroseri
	,xjp_servicecategoryid
	,timezoneruleversionnumber
	,xjp_predeliveryinspectionid
	,xjp_schedulearrivaldate
	,xjp_customeridyominame
	,xjp_servicecategoryidname
	,xjp_handling
	,xjp_newvehiclesalesorderidname
	,xjp_exteriorcoloridname
	,xjp_interiorcoloridname
	,xjp_businessunitid
	,traversedpath
	,createdonbehalfbyname
	,ktb_interfaceexceptionmessage
	,xjp_completepdidate
	,utcconversiontimezonecode
	,xjp_matchunmatchidname
	,ownerid
	,xjp_autoreceiptname
	,importsequencenumber
	,owneridyominame
	,modifiedby
	,xjp_chassisnumber
	,xjp_configurationidname
	,xjp_customerid
	,processid
	,xjp_vehicleidentificationid
	,xjp_scheduledcompletepdidate
	,createdbyname
	,xjp_type
	,xjp_deliverydate
	,modifiedonbehalfbyname
	,xjp_departmentidname
	,xjp_transactiondate
	,stageid
	,xjp_deliverytostore
	,xjp_eventdata
	,xjp_deliverytostorename
	,transactioncurrencyid
	,xjp_costdifference
	,createdby
	,xjp_deliverybusinessunitid
	,xjp_estimatedcost
	,xjp_configurationid
	,xjp_salespersonid
	,xjp_vehicleidentificationidname
	,xjp_businessunitidname
	,createdbyyominame
	,owninguser
	,transactioncurrencyidname
	,xjp_matchunmatchid
	,owningbusinessunit
	,modifiedbyyominame
	,xjp_productdescription
	,ktb_iskaroseriname
	,xjp_pdicategoryname
	,xjp_salespersonidname
	,xjp_typename
	,xjp_platenumber
	,xjp_predeliveryinspectionnumber
	,xjp_styleid
	,statuscode
	,modifiedonbehalfbyyominame
	,xjp_pdicancellationdate
	,xjp_stockid
	,ktb_isinterfaced
	,xjp_estimatedcost_base
	,statecodename
	,xjp_locking
	,RowStatus
FROM (
	SELECT
          b.ktb_bucompany company,
          b.ktb_dealercode businessunitcode
        , a.*
        , b.msdyn_companycode
    FROM CRM_xjp_predeliveryinspection a WITH(NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xjp_businessunitid
    WHERE xjp_predeliveryinspectionid = @Id
) VWI_CRM_xjp_predeliveryinspection  
