SELECT 
	ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow,  
	company, 
	businessunitcode,  
	createdby,
	createdbyname,
	createdbyyominame,
	createdon,
	createdonbehalfby,
	createdonbehalfbyname,
	createdonbehalfbyyominame,
	DealerCode,
	importsequencenumber,
	ktb_appaymentid,
	ktb_appaymentidname,
	ktb_apvoucherid,
	ktb_apvoucheridname,
	ktb_arinvoiceid,
	ktb_arinvoiceidname,
	ktb_arreceiptid,
	ktb_arreceiptidname,
	ktb_businessunitid,
	ktb_businessunitidname,
	ktb_context,
	ktb_dealeridentifier,
	ktb_employeeid,
	ktb_employeeidname,
	ktb_exceptionmessage,
	ktb_externalcode,
	ktb_externaldealerinterfacelogid,
	ktb_log,
	ktb_operation,
	ktb_operationname,
	ktb_pf,
	'' as ktb_receivedmessage, --size column is so big (include base64 from KTP), already confirm Pak Chandra Srikandi this column not used by dealer
	ktb_spkid,
	ktb_spkidname,
	ktb_transactionnumber,
	modifiedby,
	modifiedbyname,
	modifiedbyyominame,
	modifiedon,
	modifiedonbehalfby,
	modifiedonbehalfbyname,
	modifiedonbehalfbyyominame,
	overriddencreatedon,
	ownerid,
	owneridname,
	owneridtype,
	owneridyominame,
	owningbusinessunit,
	owningteam,
	owninguser,
	RowStatus,
	SourceType,
	statecode,
	statecodename,
	statuscode,
	statuscodename,
	timezoneruleversionnumber,
	utcconversiontimezonecode,
	versionnumber
FROM (
	SELECT 
    ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow,
    B.ktb_bucompany company,
    B.ktb_dealercode businessunitcode
    ,A.* 
    ,B.msdyn_companycode
    FROM CRM_ktb_externaldealerinterfacelog A WITH(NOLOCK)
    LEFT JOIN {0}dbo.CRM_businessunit B WITH(NOLOCK) 
        ON B.businessunitid = A.owningbusinessunit
) as VWI_CRM_ktb_externaldealerinterfacelog
WHERE ktb_externaldealerinterfacelogid = @ktb_externaldealerinterfacelogid