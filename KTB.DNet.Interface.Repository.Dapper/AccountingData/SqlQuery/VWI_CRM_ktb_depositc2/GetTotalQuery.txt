select 
	COUNT(1)
from (
	SELECT      
		a.[ktb_depositc2id]
		,a.[statuscode]
		,a.[modifiedbyyominame]
		,a.[createdbyname]
		,a.[transactioncurrencyid]
		,a.[modifiedon]
		,a.[ktb_dealerid]
		,a.[modifiedbyname]
		,a.[modifiedonbehalfby]
		,a.[owningbusinessunitname]
		,a.[ownerid]
		,a.[createdonbehalfbyyominame]
		,a.[ktb_documentno]
		,a.[owneridname]
		,a.[importsequencenumber]
		,a.[modifiedby]
		,a.[owninguser]
		,a.[ktb_businessunitid]
		,a.[ktb_depositc2]
		,a.[modifiedonbehalfbyname]
		,a.[statecode]
		,a.[versionnumber]
		,a.[createdon]
		,a.[createdby]
		,a.[owneridtype]
		,a.[modifiedonbehalfbyyominame]
		,a.[ktb_iddetail]
		,a.[ktb_period]
		,a.[ktb_businessunitidname]
		,a.[ktb_depositc2amount]
		,a.[overriddencreatedon]
		,a.[ktb_depositc2amount_base]
		,a.[createdonbehalfbyname]
		,a.[exchangerate]
		,a.[ktb_idheader]
		,a.[statuscodename]
		,a.[owningbusinessunit]
		,a.[timezoneruleversionnumber]
		,a.[statecodename]
		,a.[owningteam]
		,a.[transactioncurrencyidname]
		,a.[createdbyyominame]
		,a.[createdonbehalfby]
		,a.[ktb_depositc2no]
		,a.[ktb_documentdate]
		,a.[owneridyominame]
		,a.[ktb_billingnumber]
		,a.[utcconversiontimezonecode]
		,a.[DealerCode]
		,a.[SourceType]
		,a.[RowStatus]
		,a.[LastSyncDate]
		,b.msdyn_companycode
	FROM [CRM_ktb_depositc2] a WITH (NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
	ON B.businessunitid = a.ktb_businessunitid   
	{0}
) as VWI_CRM_ktb_depositc2