SELECT 
	ROW_NUMBER() OVER (ORDER BY (Select 0) ) AS IDRow
	,company
	,xts_shortname
	,versionnumber
	,xts_consumptiontax2idname
	,createdon
	,xts_vendor
	,xts_mainprovinceidname
	,xts_consumptiontax1id
	,statuscodename
	,xts_methodofpaymentidname
	,xts_requirepurchaseorderapproval
	,xts_description
	,modifiedbyyominame
	,xts_insurancecompanytypename
	,owneridtype
	,xts_classid
	,xts_requireponumberforaccountpayablename
	,createdonbehalfby
	,xts_billtoaddress1
	,modifiedbyname
	,xts_taxzoneidname
	,xts_salutation
	,xts_billtocountryidname
	,xts_internalnumber
	,xts_mainmobilephone
	,ktb_registrationagency
	,overriddencreatedon
	,xts_billtovillageandstreetid
	,xts_billtovillageandstreetidname
	,xts_billtoaddress3
	,xts_type
	,xts_billtoprovinceid
	,modifiedonbehalfby
	,xts_maincityid
	,xts_mainaddress2
	,xts_consumptiontax2id
	,xts_taxregistrationnumber
	,owningteam
	,xts_mainotherphone
	,statecode
	,xts_billtowebsite
	,timezoneruleversionnumber
	,xts_termofpaymentid
	,xts_classidname
	,xts_billtomobilephone
	,xts_termofpaymentidname
	,xts_taxzoneid
	,xts_locking
	,xts_maincountryid
	,xts_billtocountryid
	,xts_billtofax
	,xts_consumptiontax1idname
	,createdonbehalfbyname
	,xts_mainfax
	,xts_automaticallycreateapvoucher
	,xts_billtoaddress4
	,utcconversiontimezonecode
	,owneridname
	,xts_mainaddress4
	,xts_typename
	,ktb_typename
	,ownerid
	,modifiedon
	,importsequencenumber
	,owneridyominame
	,xts_vendornumber
	,xts_mainemail
	,xts_pkcombinationkey
	,xts_billtoemail
	,xts_mainpostalcode
	,xts_billtocityidname
	,xts_mainwebsite
	,createdbyname
	,xts_businessunitid
	,xts_requirepurchaseorderapprovalname
	,modifiedonbehalfbyname
	,xts_personincharge
	,xts_billtootherphone
	,xts_mainvillageandstreetidname
	,xts_automaticallycreateapvouchername
	,xts_aliasname
	,ktb_type
	,xts_billtopostalcode
	,xts_maincountryidname
	,xts_mainhomephone
	,ktb_registrationagencyname
	,createdby
	,ktb_leveldataname
	,modifiedby
	,xts_billtoaddress2
	,createdbyyominame
	,owninguser
	,createdonbehalfbyyominame
	,xts_mainaddress3
	,xts_billtoprovinceidname
	,xts_mainvillageandstreetid
	,xts_mainprovinceid
	,xts_billtohomephone
	,xts_maincityidname
	,xts_vendorid
	,xts_mainbusinessphone
	,statuscode
	,modifiedonbehalfbyyominame
	,ktb_leveldata
	,xts_insurancecompanytype
	,xts_billtocityid
	,xts_billtobusinessphone
	,xts_requireponumberforaccountpayable
	,xts_methodofpaymentid
	,xts_mainaddress1
	,statecodename
	,xts_businessunitidname
	,owningbusinessunit
	,RowStatus
	,msdyn_companycode
from (
	SELECT      
		b.ktb_bucompany company    
		, b.ktb_dealercode businessunitcode    
		, a.*  
		, b.msdyn_companycode    
	FROM CRM_xts_vendor a  WITH(NOLOCK)   
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
	ON B.businessunitid = a.xts_businessunitid 
	WHERE xts_vendorid = @Id
) VWI_CRM_xts_vendor
