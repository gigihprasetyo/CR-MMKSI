SELECT 
    ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
    , company
    , businessunitcode
    , xts_goodsreceiptid
    , xjp_weighttaxid
    , xjp_standardmarketsellingprice
    , owneridname
    , xjp_initialassessmentbusinessunitid
    , modifiedonbehalfbyname
    , overriddencreatedon
    , xts_purchasepricebaseamount_base
    , xjp_finaltotaldeposit
    , xjp_initialassessmenttradeinamount
    , xjp_initialthecapitalmanagementcharge_base
    , xjp_initialairbagequipmentname
    , xjp_finalassessmentmileage
    , xjp_finalairbagequipment
    , xjp_initialassessmentpicidname
    , transactioncurrencyidname
    , xjp_useridyominame
    , xts_purchaseprice_base
    , xjp_taxpaymentcertificatename
    , xts_vehiclemodelidname
    , xts_parentbusinessunitidname
    , xts_siteid
    , xjp_finalrecyclingobjectsname
    , xjp_automobiletaxamount
    , processid
    , xts_hasapvoucher
    , xjp_initialassessmenttradeinamount_base
    , createdonbehalfby
    , xts_purchasepricebaseamount
    , xts_goodsreceiptclassification
    , xjp_initialfluorocarbonequipmentname
    , xjp_initialshredderdustfee
    , xjp_finalassessmenttradeinamount_base
    , xjp_initialfluorocarbonclassificationname
    , xjp_initialairbagequipment
    , xts_consumptiontaxid
    , xjp_comment
    , xjp_transferbook
    , xjp_recyclingticketname
    , owneridtype
    , xjp_finalassessmentpricemeter
    , xjp_initialpurchaseprice_base
    , xjp_calichangeapprovalbill
    , owninguser
    , createdonbehalfbyname
    , xjp_finaltotalnondeposit_base
    , xts_assessmentcompletionstatusname
    , xjp_theletterofattorneyname
    , xts_transactiondate
    , xjp_standardmarketsellingprice_base
    , xts_supplieridyominame
    , xjp_finalfluorocarbonclassificationname
    , xjp_finalassessmentbusinessunitidname
    , xjp_initialshredderdustfee_base
    , xts_usedvehiclesalesorderlookupname
    , xjp_officiallyregisteredsealname
    , xts_consumptiontax
    , xjp_finalendoflifevehicle
    , xjp_vehicleschedulecost_base
    , xts_personinchargeidname
    , xjp_initialassessmentmanualmeasure3_base
    , xjp_storecost
    , xjp_antiqueledgerid
    , xjp_weighttaxidname
    , xjp_initialtotaldeposit
    , xts_hasapvouchername
    , xjp_initialairbagdepositedamount
    , xjp_useridname
    , xjp_finaldepositedpaymentcategoryname
    , timezoneruleversionnumber
    , modifiedby
    , xjp_finalfluorocarbondepositedamount
    , xts_vehicletransactionhistoryid
    , xjp_initialassessmentmanualmeasure1_base
    , modifiedonbehalfby
    , owneridyominame
    , xjp_vehicleschedulecost
    , xjp_documentcompleteddate
    , xts_handlingname
    , xjp_initialendoflifevehicle
    , xjp_antiqueledgeridname
    , owningteam
    , xjp_ownerid
    , xts_goodsreceiptnumber
    , xjp_initialassessmentgoodsreceiptclassify
    , xts_businessunitid
    , xjp_documenteffectivedate
    , xjp_consumptiontaxcategory
    , xjp_finalairbagequipmentname
    , xts_newvehiclesalesorderidname
    , xjp_selection
    , xts_sellingprice_base
    , xjp_theletterofattorney
    , xjp_initialassessmentnewcarmeasure_base
    , xjp_finalpurchaseprice
    , xjp_initialassessmentgoodsreceiptclassifyname
    , createdbyyominame
    , xjp_carinspectioninstruction
    , xjp_documentcompletionstatusname
    , createdon
    , xjp_finalassessmenttradeinamount
    , xts_locking
    , xts_firstyearregistration
    , xts_stockidname
    , xjp_finalinformationmanagementcharge_base
    , xjp_consumptiontaxcategoryname
    , xjp_automobiletaxidname
    , xts_guaranteemileage
    , xjp_finalfluorocarbonequipmentname
    , xjp_initialassessmentmileagebeforeexchanges
    , xjp_finalassessmentnewcarmeasure
    , xjp_redeemname
    , exchangerate
    , xjp_initialassessmentmanualmeasure1
    , xjp_initialassessmentmanualmeasure2
    , xjp_initialassessmentmanualmeasure3
    , xts_wholesaleprice_base
    , xjp_initialassessmentnewcarmeasure
    , xts_stockid
    , xjp_finalassessmentnewcarmeasure_base
    , xjp_finalairbagdepositedamount
    , xjp_finalassessmentmanualmeasure1_base
    , xjp_owneridyominame
    , xts_newvehiclesalesorderid
    , xts_warrantyperiod
    , xts_goodsreceiptclassificationname
    , xjp_idempotentmessage
    , xjp_initialfluorocarbondepositedamount_base
    , xjp_initialdepositedpaymentcategory
    , xjp_finalassessmentdate
    , xjp_finalassessmentgoodsreceiptclassification
    , xjp_newcarguaranteesuccession
    , xjp_finalshredderdustfee
    , xjp_firstyearregistrationjapan
    , xts_carinspectionexpirationdate
    , xjp_storecost_base
    , xjp_automobiletaxid
    , statuscode
    , xts_supplierid
    , xts_consumptiontaxamount
    , xjp_initialassessmentmileage
    , xjp_initialrecyclingobjectsname
    , xts_locationid
    , xjp_initialrecyclingobject
    , xts_warrantytypeid
    , xts_initialassessmentid
    , xjp_finalfluorocarbonclassification
    , xts_salesorderid
    , xts_finalassessmentid
    , xts_initialassessmentidname
    , xjp_carinspectionexpirationdatejapan
    , xts_suppliervendorinvoicedate
    , owningbusinessunit
    , xts_personinchargeid
    , xjp_transferbookname
    , xjp_finalassessmentbusinessunitid
    , xjp_laststatus
    , xjp_finalassessmentmanualmeasure1
    , xjp_userid
    , xjp_finalassessmentmanualmeasure3
    , xjp_finalassessmentmanualmeasure2
    , xjp_newcarguaranteesuccessionname
    , xjp_initialdepositedpaymentcategoryname
    , xjp_specificproductionyearforuvmireport
    , xjp_finalassessmentmanualmeasure2_base
    , xts_supplierdescription
    , xjp_finalassessmentpricemeter_base
    , xjp_initialassessmentpricemeter
    , xjp_initialassessmentrunningmeterexchangename
    , xts_purchasepricetotal_base
    , xjp_finaltotalnondeposit
    , xts_usedvehiclesalesorderlookuptype
    , xjp_residentscardname
    , xts_sellingprice
    , xts_consumptiontaxname
    , xjp_initialassessmentmanualmeasure2_base
    , xjp_grade
    , xjp_compulsoryinsurancecertificate
    , xts_vehiclemodelid
    , xts_parentbusinessunitid
    , xjp_finalassessmentmileagebeforeexchanges
    , xjp_salepricecompletionstatusname
    , xts_handling
    , transactioncurrencyid
    , xjp_finalinformationmanagementcharge
    , statuscodename
    , xjp_automobileinspectioncertificate
    , xts_internalsalesprice_base
    , xjp_residentscard
    , xjp_finalassessmentstatusname
    , xjp_finalairbagdepositedamount_base
    , modifiedon
    , xts_purchasepricetotal
    , xjp_initialinformationmanagementcharge
    , xjp_initialassessmentdate
    , xjp_initialassessmentbusinessunitidname
    , xjp_initialassessmentpricemeter_base
    , xjp_finalpurchaseprice_base
    , xts_exteriorcolorid
    , xjp_officiallyregisteredseal
    , xjp_owneridname
    , xjp_selectionname
    , traversedpath
    , xts_supplieridname
    , xjp_newvehicleguaranteesuccessionname
    , xjp_finaltotaldeposit_base
    , xjp_initialassessmentpicid
    , xjp_finalrecyclingobjectname
    , createdonbehalfbyyominame
    , statecodename
    , xjp_taxpaymentcertificate
    , xjp_nonsalesdeliveryid
    , xts_consumptiontaxamount_base
    , xjp_incompletedocument1
    , xjp_documentcompletionstatus
    , xjp_incompletedocument2
    , xjp_recognizedmodelforuvmireport
    , xjp_finalassessmentpicid
    , ownerid
    , xjp_finalshredderdustfee_base
    , xts_exteriorcoloridname
    , stageid
    , xjp_finalassessmentmanualmeasure3_base
    , xjp_finalassessmentrunningmeterexchange
    , xjp_finaldepositedpaymentcategory
    , xts_suppliervendorinvoicenumber
    , xts_warrantytypeidname
    , xjp_compulsoryinsurancecertificatename
    , xjp_initialtotalnondeposit
    , xjp_automobiletaxamount_base
    , xjp_initialfluorocarbonequipment
    , xts_warehouseid
    , xjp_initialassessmentrunningmeterexchange
    , xjp_initialairbagdepositedamount_base
    , xts_vendoridname
    , createdbyname
    , xts_businessunitidname
    , xjp_initialinformationmanagementcharge_base
    , modifiedbyyominame
    , xts_siteidname
    , xts_locationidname
    , modifiedonbehalfbyyominame
    , createdby
    , xts_platenumber
    , xjp_calichangeapprovalbillname
    , xjp_finalthecapitalmanagementcharge
    , xjp_initialfluorocarbonclassification
    , xts_vehicletransactionhistoryidname
    , xjp_newvehicleguaranteesuccession
    , xjp_finalassessmentstatus
    , xjp_initialrecyclingobjectname
    , importsequencenumber
    , xjp_finalrecyclingobject
    , xts_wholesaleprice
    , utcconversiontimezonecode
    , xjp_carinspectioninstructionname
    , xjp_nonsalesdeliveryidname
    , xts_vendorid
    , xjp_finalassessmentpicidname
    , xts_finalassessmentidname
    , xjp_finalthecapitalmanagementcharge_base
    , xts_minimumsalespriceforretail_base
    , xjp_recyclingticket
    , xts_internalsalesprice
    , xjp_weighttaxamount
    , xjp_initialfluorocarbondepositedamount
    , xjp_finalassessmentgoodsreceiptclassificationname
    , versionnumber
    , xjp_redeem
    , xts_warehouseidname
    , xjp_initialtotalnondeposit_base
    , xts_salesorderidname
    , xts_minimumsalespriceforretail
    , xts_status
    , xjp_finalfluorocarbonequipment
    , xjp_initialrecyclingobjects
    , xts_statusname
    , modifiedbyname
    , xjp_initialthecapitalmanagementcharge
    , xjp_finalrecyclingobjects
    , xjp_finalendoflifevehiclename
    , xts_assessmentcompletionstatus
    , xjp_weighttaxamount_base
    , xjp_automobileinspectioncertificatename
    , xjp_initialendoflifevehiclename
    , xts_purchaseprice
    , xjp_finalfluorocarbondepositedamount_base
    , xjp_salepricecompletionstatus
    , xjp_initialtotaldeposit_base
    , xjp_finalassessmentrunningmeterexchangename
    , xts_consumptiontaxidname
    , xjp_initialpurchaseprice
    , xts_vehicleidentificationnumber
    , statecode
    , msdyn_companycode
FROM (
	SELECT 
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.* 
        , b.msdyn_companycode
    FROM CRM_xts_goodsreceipt a WITH(NOLOCK)
    LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
    WHERE xts_goodsreceiptid = @Id
) as VWI_CRM_xts_goodsreceipt 
