SELECT 
	ROW_NUMBER() OVER (ORDER BY (Select 0) ) AS IDRow
	,company
	,businessunitcode
	,xts_totalmiscchargeamount
	,xts_contactpersonid
	,ktb_statusinterfaceassistpartsalesdnet
	,xts_totalmiscchargebaseallocated
	,xts_vehiclesizeclassid
	,ktb_isinterfacedname
	,xts_esttotalothersalesbaseamount_base
	,modifiedonbehalfbyname
	,ktb_countedprint
	,overriddencreatedon
	,xts_actualservicestartdateandtime
	,xts_invoicedname
	,xts_dimension5id
	,xts_totalothersalesbaseallocated_base
	,ktb_isprintgatepassreadytobeinvoicename
	,xts_symptomcauseid
	,ktb_isfreebilltocustomername
	,importsequencenumber
	,xts_claimstatusname
	,xts_pickupaddress4
	,xts_queuestatusname
	,xts_workordermemo
	,ktb_statusinterfacefreeservicednet
	,xjp_estcaliamount_base
	,xts_totalpartsamount
	,xts_esttotaltaxamount_base
	,ktb_vehiclestatename
	,xts_esttotalothersalestaxamount_base
	,xts_grandtotalamount_base
	,ktb_say
	,xts_esttotalworktaxamount_base
	,xts_totalmiscchargebaseamount_base
	,xts_totalpartsallocated_base
	,xts_woinsurancereceiptnumber
	,xts_esttotalothersalestaxamount
	,xts_incomingoutsourcebusinessunitidname
	,xts_siteidname
	,statecodename
	,xts_paymentreceivedamount_base
	,xts_estgrandtotalamount
	,xts_lastmileage
	,ktb_svcincominginterfacestatusname
	,xts_billtocustomeridyominame
	,ktb_origworkordernumber
	,xts_dimension5idname
	,xts_originaloutsorcereferencesvcinstructionid
	,xts_araccountidname
	,xts_invoiced
	,xts_deliverypostalcode
	,xts_originalworkorderreferencenumberidname
	,ktb_paneltypeid
	,xts_productid
	,xts_totalpartstaxamount_base
	,traversedpath
	,xts_totalcostamount_base
	,xjp_caliallocated
	,xts_totalmiscchargenotallocated
	,xts_customeridyominame
	,xts_totalpartsbaseallocated_base
	,xts_servicepersoninchargeidname
	,xts_totalworktaxnotallocated_base
	,xts_workorder
	,xts_workgroupidname
	,xts_totalworktaxallocated_base
	,ktb_workordermemo
	,ktb_svcincominginterfacestatus
	,xts_pickuppostalcode
	,xts_vehiclemodelname
	,owningbusinessunit
	,xts_globalserviceid
	,xts_productsegment3idname
	,xts_scheduledservicestartdateandtime
	,ktb_countprintinvoice
	,xts_vehicleincludedintherecall
	,ktb_servicetypeid
	,xts_warrantycontractavailablename
	,xts_totalmiscchargebaseamount
	,ktb_contactidname
	,ktb_isprintgatepassreadytobeinvoice
	,xts_totalworkbaseallocated
	,xts_servicecategorydescription
	,xts_originaloutsorcereferenceoutsourcewoidname
	,xts_estgrandtotalamount_base
	,xts_loadinggroupid
	,xts_handling
	,ktb_statusinterfaceregcheckdnetname
	,xts_originaloutsorcereferencelookuptype
	,xts_productsegment2id
	,xts_totalothersalesnotallocated_base
	,xts_incomingoutsourcebusinessunitid
	,versionnumber
	,xts_originalcustomerid
	,xts_grandtotalnotallocated
	,xts_queuestatus
	,xjp_originaloutsorcereferencepdiid
	,ktb_saleschannelidname
	,xts_reservationidname
	,ktb_totalpartamount_base
	,xts_reservationmanhour
	,xts_referencenumberlookupname
	,xts_symptomcauseidname
	,xts_esttotalpartstaxamount_base
	,xts_productidname
	,xts_productsegment3id
	,xts_esttotalwithholdingtaxamount_base
	,xts_totalothersalesamount
	,ktb_wodate
	,xts_originaloutsorcereferencelookupname
	,ktb_panelcategoryname
	,xts_downpaymentamountreceived
	,xts_servicetemplateid
	,xts_billtocustomerid
	,xts_platenumber
	,xts_totalpaymentamount_base
	,xts_billtocustomeridname
	,xts_totalworkamount_base
	,xts_isworkorderformname
	,xjp_caliamount_base
	,xts_totalothersalesamount_base
	,xjp_calinotallocated_base
	,xts_customernumber
	,xts_totalmiscchargenotallocated_base
	,ktb_eventdata
	,xts_esttotalpartstaxamount
	,xjp_caliexpirationdate
	,xts_productsegment1id
	,ktb_liststatusinterface
	,transactioncurrencyidname
	,xts_manufactureridname
	,ktb_ordertypetranstype
	,xts_workorderstatus
	,ktb_totalpartamount
	,xts_actualservicefinishdateandtime
	,xts_dimension6idname
	,ktb_interfacehandlingdnet
	,createdonbehalfbyname
	,xts_productdescription
	,xts_arrivalpattern
	,xts_totalothersalesallocated_base
	,xts_totalmiscchargeallocated
	,xts_technicaladvisoridname
	,ktb_contactidyominame
	,xts_totalworktaxallocated
	,xts_overcreditlimitonholdname
	,ktb_totalsuborderamount_base
	,xts_maintenancemodelidname
	,transactioncurrencyid
	,xts_totalbaseamount_base
	,xts_esttotaltaxamount
	,xts_originaloutsorcereferenceoutsourcewoid
	,xts_totalmiscchargebasenotallocated
	,owneridname
	,xts_totalmiscchargetaxamount_base
	,xts_esttotalwithholdingtaxamount
	,xts_dimension7idname
	,xts_esttotalworkamount_base
	,ktb_interfacehandling
	,xts_totalothersalesbaseallocated
	,xts_isworkorderform
	,ktb_totalserviceamount_base
	,xts_actualarrivaldateandtime
	,xts_totalwithholdingtaxallocated_base
	,xts_totalworknotallocated_base
	,xts_esttotalpartsamount
	,xts_esttotalpartsbaseamount_base
	,xts_totalwithholdingtaxnotallocated
	,xts_dimension10idname
	,xts_servicecampaignidname
	,xts_incomingoutsourcereferenceidname
	,xts_totaltaxamount
	,xts_mainpartcauseid
	,exchangerate
	,xts_balance
	,modifiedonbehalfbyyominame
	,xts_pickupaddress1
	,xts_vehicleinspectionexpirationdate
	,xts_productsegment4id
	,xts_servicetemplatecalculationmethod
	,xts_dimension4idname
	,xts_totalpartsbaseallocated
	,xts_exchangeratetypeidname
	,xts_totalworktaxamount_base
	,ktb_statusinterfacednet
	,xts_workorderreferenceid
	,xts_workorderid
	,xts_behaviorname
	,xts_servicetemplatecalculationmethodname
	,ktb_paneltypeidname
	,ktb_saleschannelid
	,xts_reservationclassid
	,xts_totalworkbaseamount_base
	,xts_insuranceinspectiondate
	,xts_exchangerateamount
	,xts_cancelreason
	,xts_exchangeratedate
	,xts_finishpatternname
	,xts_totalpartstaxnotallocated_base
	,xts_totalmiscchargeallocated_base
	,xts_claimapprovalnumber
	,xjp_caliallocated_base
	,xts_totalothersalestaxamount_base
	,xts_totalpartsbaseamount
	,xts_grandtotalnotallocated_base
	,ktb_paneldescription
	,xts_downpaymentamount
	,xts_serviceadvisorid
	,xjp_estcaliperiodmonths
	,xts_siteid
	,xts_esttotalmiscchargetaxamount
	,xts_dimension9idname
	,xts_globalserviceidname
	,ktb_servicelocationidname
	,ktb_validatorhandling
	,xts_totalmiscchargetaxamount
	,ktb_servicetypeidname
	,xts_log
	,xts_contactpersonphone
	,ktb_totaloilamount_base
	,xts_dimension8idname
	,ktb_methodofpaymentid
	,xts_reservationclassidname
	,ktb_paneldeskripsi
	,ktb_isinsurance
	,xjp_firstregistration
	,createdon
	,xts_invoicepostingdate
	,xts_totalworktaxamount
	,xts_totalpartstaxallocated_base
	,xts_totalothersalesallocated
	,ktb_totalserviceamount
	,xts_autocreateoutsourceworkorderreceiptname
	,xts_aliasname
	,xts_totalmiscchargetaxallocated
	,ktb_validatorhandlingname
	,ktb_statusinterfaceregcheckdnet
	,ktb_totalsuborderamount
	,xts_deliveryaddress4
	,xts_servicepersoninchargeid
	,ktb_notificationvalidatorservice
	,xts_esttotalworkbaseamount_base
	,ktb_dnetidserviceincoming
	,xts_vehiclemodelid
	,xts_servicecategoryidname
	,xts_currentmileage
	,xts_locking
	,xts_claimstatus
	,xts_workorderreferenceidname
	,xts_totalpartsbasenotallocated
	,xts_chassisnumber
	,xts_totalothersalestaxamount
	,xts_symptomidname
	,ktb_cogsupdated
	,xts_totalpartstaxnotallocated
	,ktb_isinterfaced
	,xts_historymileage
	,createdbyname
	,xts_totalworkbasenotallocated_base
	,ktb_tanggalinputmerimen
	,xts_dimension1idname
	,xts_grandtotalamount
	,xts_downpaymentamount_base
	,statecode
	,xts_araccountid
	,statuscode
	,ktb_notificationvalidatormessage
	,xts_totalothersalesbaseamount
	,xts_totalworktaxnotallocated
	,xts_esttotalworkamount
	,xjp_caliperiodmonths
	,xts_totalpartstaxamount
	,xts_totalothersalestaxnotallocated_base
	,xts_totalworkamount
	,xts_scheduledarrivaldateandtime
	,xts_dimension2idname
	,xts_originalcustomeridyominame
	,xts_contactpersonidyominame
	,xts_accidentdate
	,xts_servicetemplatevehiclepriceclassid
	,ktb_tanggalterbitspk
	,xts_exchangerate
	,xts_paymentreceivedamount
	,xts_originalcustomeridname
	,xts_esttotalmiscchargetaxamount_base
	,xts_arrivalpatternname
	,ktb_statusinterface
	,xts_transactiondate
	,statuscodename
	,xts_totalothersalestaxnotallocated
	,owninguser
	,xts_totalothersalesbasenotallocated
	,ktb_totalsubmaterialamount_base
	,ktb_interfacehandlingname
	,xts_customeridname
	,xts_checkstockagainstname
	,xts_handlingname
	,xts_modelspecificationnumber
	,xts_checkstockagainst
	,xts_parentbusinessunitidname
	,xts_dimension4id
	,xts_dslinternalnumber
	,xts_servicetemplatevehiclepriceclassidname
	,modifiedbyname
	,xts_totalothersalestaxallocated_base
	,owneridtype
	,xts_dimension9id
	,xts_totalworkallocated_base
	,xts_businessunitid
	,xts_pickupaddress2
	,xts_totalwithholdingtaxnotallocated_base
	,ktb_vehiclestate
	,ktb_isfreebilltocustomer
	,xts_totalmiscchargetaxnotallocated_base
	,ktb_panel
	,xts_esttotalbaseamount_base
	,xts_totalpartsamount_base
	,xts_downpaymentispaidname
	,ktb_contactmobilephonenumber
	,xts_dimension10id
	,xts_deliveryaddress2
	,xts_vehicleidentificationid
	,xts_incomingoutsourcereferenceid
	,ktb_fullpaymentdate
	,xts_totalpartsnotallocated_base
	,xts_totalmiscchargetaxnotallocated
	,xts_totalpartstaxallocated
	,xts_esttotalbaseamount
	,xts_servicecategoryid
	,xts_exchangeratetypeid
	,xjp_originaloutsorcereferencepdiidname
	,ktb_statusinterfaceassistpartsalesdnetname
	,xts_dimension3idname
	,ktb_statusinterfacefreeservicednetname
	,xts_meterexchangemileage
	,ktb_cogsupdatedname
	,ktb_methodofpaymentidname
	,xts_ordertypeidname
	,xts_scheduledservicefinishdateandtime
	,xts_chassismodel
	,ktb_workorderdescription
	,xts_reservationid
	,timezoneruleversionnumber
	,createdonbehalfbyyominame
	,xts_esttotalothersalesamount
	,xts_registrationmodel
	,xts_totalpartsallocated
	,xts_totalworkallocated
	,xts_downpaymentamountreceived_base
	,xts_mainpartcauseidname
	,ownerid
	,ktb_mechanicalleaderemployeeidname
	,xts_dimension8id
	,xts_totalworkbaseamount
	,xts_esttotalmiscchargebaseamount_base
	,xts_warrantycontractavailable
	,modifiedonbehalfby
	,xts_servicepackagecontractavailablename
	,xts_dimension6id
	,owningteam
	,ktb_isinsurancename
	,ktb_statusinterfacednetname
	,xts_totalothersalesbaseamount_base
	,xts_totalwithholdingtaxallocated
	,xts_vehicleincludedintherecallname
	,xts_totalpartsbaseamount_base
	,xts_readytobeinvoiced
	,xts_esttotalothersalesbaseamount
	,xts_totalwithholdingtaxamount
	,xts_vehicleidentificationidname
	,xts_customerid
	,xts_pickupaddress3
	,xts_manufacturername
	,owneridyominame
	,ktb_totalsubmaterialamount
	,xts_parentbusinessunitid
	,xts_billallocationmethodname
	,xts_grandtotalallocated_base
	,xts_serviceadvisoridname
	,createdbyyominame
	,stageid
	,xts_deliveryaddress3
	,xts_overcreditlimitonhold
	,xts_vehiclesizeclassidname
	,xts_ordertypeid
	,xts_salespersonid
	,xts_finishpattern
	,xts_symptomid
	,xts_balance_base
	,xts_esttotalworkbaseamount
	,xts_deliveryaddress1
	,xts_maintenancemodelid
	,xjp_idempotentmessage
	,ktb_isvalidationfromdnet
	,xts_classificationnumber
	,xts_esttotalworktaxamount
	,xts_contactpersonidname
	,xts_dimension3id
	,xts_totalmiscchargetaxallocated_base
	,modifiedby
	,xts_totalworknotallocated
	,xts_esttotalpartsbaseamount
	,xts_actualfinishdateandtime
	,xts_totalothersalesnotallocated
	,xts_totaltaxamount_base
	,xts_totalpartsnotallocated
	,xts_referralname
	,xts_totalcostamount
	,xts_manufacturerid
	,xts_servicepackagecontractavailable
	,xts_totalworkbasenotallocated
	,xts_termofpaymentid
	,xjp_calinotallocated
	,xts_readytobeinvoicedname
	,xts_leaseapprovalnumber
	,xts_behavior
	,xts_servicecampaignid
	,ktb_totaloilamount
	,xts_totalmiscchargeamount_base
	,ktb_interfacehandlingdnetname
	,xts_productsegment1idname
	,xts_totalworkbaseallocated_base
	,xts_billallocationmethod
	,xts_grandtotalallocated
	,utcconversiontimezonecode
	,xts_salespersonidname
	,xjp_caliamount
	,ktb_ordertypetranstypename
	,xts_totalpartsbasenotallocated_base
	,xts_esttotalmiscchargeamount_base
	,ktb_contactid
	,xts_totalmiscchargebaseallocated_base
	,ktb_interfacemessage
	,xts_totalwithholdingtaxamount_base
	,xts_dimension7id
	,xts_workorderstatusname
	,xts_dimension1id
	,xts_totalmiscchargebasenotallocated_base
	,xts_servicetemplateidname
	,xts_vehiclemodelidname
	,ktb_mechanicalleaderemployeeid
	,xts_autocreateoutsourceworkorderreceipt
	,xjp_estcaliamount
	,xts_totalpaymentamount
	,processid
	,xts_termofpaymentidname
	,xts_downpaymentispaid
	,xts_esttotalmiscchargeamount
	,modifiedon
	,xts_totalothersalesbasenotallocated_base
	,xts_esttotalmiscchargebaseamount
	,xts_productsegment2idname
	,xts_productsegment4idname
	,xts_businessunitidname
	,ktb_panelcategory
	,xts_scheduledfinishdateandtime
	,xts_dimension2id
	,modifiedbyyominame
	,createdonbehalfby
	,xts_originalworkorderreferencenumberid
	,xts_totalbaseamount
	,ktb_estimationfinishdatebysa
	,ktb_dnetidwotype
	,xts_totalothersalestaxallocated
	,xts_originaloutsorcereferencesvcinstructionidname
	,xts_technicaladvisorid
	,ktb_servicelocationid
	,createdby
	,xts_loadinggroupidname
	,xts_esttotalothersalesamount_base
	,xts_esttotalpartsamount_base
	,xts_workgroupid
	,RowStatus
	,ktb_grandtotalinformationdetail
	,ktb_grandtotalinformationdetail_base
	,ktb_totalmiscchargeamount
	,ktb_ownriskamount_base
	,ktb_totalmiscchargeamount_base
	,ktb_spknumber
	,ktb_ownriskamount
	,xts_totalwithholdingtax2allocated_base
	,ktb_formsprosurveyinvitationid
	,ktb_approvedcreditlimitreason
	,ktb_approvedcreditlimitbyname
	,ktb_approvedcreditlimitbyyominame
	,xts_totalwithholdingtax2notallocated
	,ktb_approvedcreditlimitby
	,xts_totalwithholdingtax2allocated
	,xts_totalwithholdingtax2notallocated_base
	,ktb_formsprosurveyinvitationidname
	,msdyn_companycode
	,ktb_externalcode
	,ktb_isinbound
from (
	SELECT      
		b.ktb_bucompany company    
		, b.ktb_dealercode businessunitcode    
		, a.*  
		, b.msdyn_companycode    
	FROM CRM_xts_workorder a  WITH(NOLOCK)   
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
	ON B.businessunitid = a.xts_businessunitid 
	WHERE xts_workorderid = @Id
) VWI_CRM_xts_workorder
