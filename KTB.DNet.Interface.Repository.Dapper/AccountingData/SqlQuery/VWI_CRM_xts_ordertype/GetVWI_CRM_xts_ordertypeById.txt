SELECT 
	ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	,company
	,businessunitcode
	,xts_discountdimension6fromname
	,xts_cogsdimension7id
	,ktb_defaultlocationwoname
	,xts_cogsdimension4id
	,xts_discdimension10id
	,overriddencreatedon
	,xts_downpaymentdimension4id
	,statuscodename
	,xts_ardimension2idname
	,xts_salesdimension3id
	,modifiedbyyominame
	,xts_salesdimension10idname
	,ktb_ordertypetointerface
	,xts_discountaccountfromname
	,xts_salesaccountfromname
	,xts_discdimension9idname
	,xts_cogsdimension5idname
	,xts_salesdimension4idname
	,xts_salesaccountfrom
	,xts_behaviour
	,ktb_isnoprice
	,xts_discdimension4id
	,ktb_isbilltoatpm
	,xts_salesdimension4fromname
	,xts_discountdimension6from
	,ktb_isfreeservice
	,owningbusinessunit
	,xts_partspricecalculationmethod
	,xts_cogsdimension10id
	,xts_ardimension1id
	,xts_downpaymentdimension4idname
	,ktb_transtype
	,xts_ardimension2id
	,xts_discdimension2id
	,xts_salesdimension4from
	,xts_salesdimension3from
	,statuscode
	,xts_servicetemplateparentgroupidname
	,xts_ordertypeid
	,xts_salesdimension6fromname
	,xts_discountdimension1from
	,xts_salesdimension3idname
	,xts_cogsdimension9id
	,xts_salesdimension4id
	,xts_partspricecalculationmethodname
	,ktb_interfacedtoexternalsystem
	,xts_salesdimension2fromname
	,xts_discdimension3idname
	,xts_salesdimension7idname
	,statecodename
	,xts_discountdimension5fromname
	,xts_cogsdimension1idname
	,xts_salesdimension1id
	,xts_downpaymentdimension6idname
	,xts_discdimension7id
	,ownerid
	,modifiedon
	,xts_ardimension3idname
	,ktb_ordertypetointerfacename
	,xts_ardimension5id
	,xts_salesdimension5id
	,xts_cogsdimension6id
	,ktb_defaultwarehouseid
	,ktb_bodypaint
	,createdon
	,ktb_isonlyshownongenuineproductinwopmsname
	,xts_ordertype
	,ktb_isonlyshownongenuineproductinwopms
	,xts_cogsdimension3idname
	,createdonbehalfby
	,xts_salesdimension10id
	,xts_discdimension10idname
	,xts_ordervehiclename
	,xts_cogsdimension9idname
	,xts_discountdimension1fromname
	,xts_cogsdimension6idname
	,xts_discountdimension4fromname
	,owneridyominame
	,xts_ardimension6id
	,xts_downpaymentdimension2id
	,xts_discountaccountfrom
	,xts_salesaccountidname
	,ktb_issmartpackagename
	,modifiedby
	,xts_salesdimension5idname
	,timezoneruleversionnumber
	,ktb_isfreeservicename
	,xts_aftervso
	,xts_discdimension7idname
	,ktb_bodypaintname
	,modifiedonbehalfby
	,xts_discdimension9id
	,xts_ardimension5idname
	,ktb_isnopricename
	,xts_cogsdimension7idname
	,xts_downpaymentdimension5id
	,xts_cogsdimension4idname
	,xts_cogsdimension5id
	,createdonbehalfbyname
	,owninguser
	,ktb_description
	,xts_cogsaccountid
	,xts_cogsdimension8idname
	,ktb_ordertypetranstypename
	,owneridtype
	,xts_discountaccountid
	,xts_behaviourname
	,owneridname
	,modifiedonbehalfbyname
	,xts_salesdimension5from
	,ktb_interfacedtoexternalsystemname
	,xts_cogsdimension2idname
	,xts_servicetemplategroupid
	,xts_salesdimension6idname
	,xts_servicetemplategroupidname
	,xts_downpaymentdimension6id
	,xts_discdimension3id
	,owningteam
	,xts_aftervsoname
	,xts_discountdimension3from
	,ktb_validatorwotruename
	,versionnumber
	,ktb_isprintgatepassreadytobeinvoicename
	,ktb_issmartpackage
	,xts_salesdimension5fromname
	,xts_discdimension8idname
	,xts_discountdimension2from
	,xts_aftersales
	,xts_salesdimension1from
	,xts_discdimension1idname
	,xts_ardimension3id
	,xts_discdimension2idname
	,xts_salesdimension1fromname
	,createdonbehalfbyyominame
	,xts_downpaymentdimension1id
	,ktb_isbilltoatpmname
	,xts_salesdimension6id
	,xts_cogsdimension2id
	,xts_cogsdimension3id
	,ktb_defaultwarehouseidname
	,xts_salesdimension9idname
	,xts_discountdimension5from
	,xts_salesdimension6from
	,xts_discdimension4idname
	,xts_aftersalesname
	,xts_cogsdimension8id
	,createdbyname
	,xts_discdimension1id
	,xts_salesdimension1idname
	,xts_salesdimension3fromname
	,xts_businessunitidname
	,statecode
	,xts_ardimension4idname
	,modifiedonbehalfbyyominame
	,createdby
	,xts_discdimension8id
	,xts_discdimension5id
	,xts_discdimension6id
	,xts_salesdimension8idname
	,xts_ordervehicle
	,xts_downpaymentdimension3id
	,xts_salesdimension2from
	,utcconversiontimezonecode
	,xts_discdimension5idname
	,xts_downpaymentdimension5idname
	,xts_discdimension6idname
	,xts_ardimension4id
	,importsequencenumber
	,xts_locking
	,xts_cogsdimension1id
	,xts_discountdimension2fromname
	,xts_ardimension6idname
	,xts_downpaymentdimension3idname
	,xts_salesdimension7id
	,xts_cogsaccountidname
	,xts_salesaccountid
	,xts_businessunitid
	,xts_downpaymentdimension1idname
	,ktb_defaultlocationwo
	,xts_salesdimension2idname
	,ktb_isprintgatepassreadytobeinvoice
	,xts_discountdimension4from
	,xts_salesdimension8id
	,xts_discountdimension3fromname
	,xts_servicetemplateparentgroupid
	,modifiedbyname
	,createdbyyominame
	,ktb_ordertypetranstype
	,xts_ardimension1idname
	,xts_discountaccountidname
	,xts_downpaymentdimension2idname
	,ktb_validatorwotrue
	,xts_salesdimension2id
	,xts_cogsdimension10idname
	,xts_salesdimension9id
	,RowStatus
	,xts_pkcombinationkey
	,xts_regularservicename
	,xts_regularservice
	,msdyn_companycode
FROM (
	SELECT     
        b.ktb_bucompany company  
        , b.ktb_dealercode businessunitcode  
        , a.*   
        , b.msdyn_companycode  
    FROM CRM_xts_ordertype a WITH(NOLOCK)  
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
    WHERE xts_ordertypeid = @Id
) VWI_CRM_xts_ordertype
