SELECT 
	ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	,businessunitcode
	,subcategory
	,prioritycodename
	,versionnumber
	,createdon
	,modifiedonbehalfbyyominame
	,activitytypecodename
	,from
	,resources
	,statuscodename
	,isregularactivityname
	,traversedpath
	,activityid
	,xts_salesobjective
	,owneridtype
	,xts_manufacturerid
	,ismapiprivatename
	,customers
	,createdonbehalfby
	,deliverylastattemptedon
	,postponeactivityprocessinguntil
	,onholdtime
	,createdbyyominame
	,xts_vehiclemodelidname
	,regardingobjectidyominame
	,owneridname
	,prioritycode
	,overriddencreatedon
	,xts_vehiclemodelid
	,exchangeitemid
	,scheduledstart
	,createdonbehalfbyyominame
	,isbilled
	,exchangerate
	,deliveryprioritycodename
	,excludeifcontactedinxdays
	,budgetedcost_base
	,owningteam
	,xts_vehiclebrandid
	,deliveryprioritycode
	,sendermailboxid
	,xts_productidname
	,regardingobjectid
	,statecode
	,exchangeweblink
	,activityadditionalparams
	,seriesid
	,timezoneruleversionnumber
	,bcc
	,xts_businessunitid
	,xts_productexteriorcoloridname
	,modifiedonbehalfby
	,xts_locking
	,community
	,xts_manufactureridname
	,actualcost_base
	,regardingobjectidname
	,slainvokedidname
	,ignoreinactivelistmembers
	,createdonbehalfbyname
	,ignoreinactivelistmembersname
	,actualstart
	,xts_productexteriorcolorid
	,utcconversiontimezonecode
	,activitytypecode
	,instancetypecodename
	,lastonholdtime
	,slaid
	,slainvokedid
	,sortdate
	,ownerid
	,modifiedon
	,importsequencenumber
	,owneridyominame
	,scheduleddurationminutes
	,category
	,processid
	,actualcost
	,description
	,slaname
	,to
	,createdbyname
	,regardingobjecttypecode
	,xts_salesobjectivename
	,modifiedonbehalfbyname
	,ismapiprivate
	,isworkflowcreatedname
	,requiredattendees
	,donotsendonoptout
	,stageid
	,partners
	,checkfordonotsendmmonlistmembersname
	,leftvoicemail
	,optionalattendees
	,xts_productid
	,channeltypecode
	,instancetypecode
	,createdby
	,modifiedby
	,organizer
	,serviceid
	,channeltypecodename
	,isworkflowcreated
	,owninguser
	,transactioncurrencyidname
	,actualend
	,owningbusinessunit
	,xts_vehiclebrandidname
	,transactioncurrencyid
	,modifiedbyyominame
	,typecodename
	,sendermailboxidname
	,isregularactivity
	,cc
	,isbilledname
	,senton
	,scheduledend
	,statuscode
	,modifiedbyname
	,budgetedcost
	,actualdurationminutes
	,typecode
	,subject
	,leftvoicemailname
	,statecodename
	,xts_businessunitidname
	,communityname
	,RowStatus
FROM (
	select    
		 b.ktb_bucompany company  
		 ,b.ktb_dealercode businessunitcode  
		 ,a.*
		 ,b.msdyn_companycode 
	from CRM_campaignactivity a WITH(NOLOCK)
	JOIN CRM_businessunit b WITH(NOLOCK) 
	ON b.businessunitid = a.xts_businessunitid
	where campaignactivityid = @Id
) VWI_CRM_campaignactivity 