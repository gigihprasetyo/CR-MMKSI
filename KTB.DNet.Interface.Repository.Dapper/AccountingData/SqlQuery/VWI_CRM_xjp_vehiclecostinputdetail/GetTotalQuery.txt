select 
	COUNT(1)
from (
	SELECT      
		a.[xjp_parentbusinessunitidname]
		,a.[modifiedbyyominame]
		,a.[createdbyname]
		,a.[xjp_amount_base]
		,a.[modifiedon]
		,a.[ownerid]
		,a.[modifiedbyname]
		,a.[xjp_vehiclecostinputidname]
		,a.[modifiedonbehalfby]
		,a.[owningbusinessunitname]
		,a.[statuscode]
		,a.[createdonbehalfbyyominame]
		,a.[xjp_landedcostdescription]
		,a.[importsequencenumber]
		,a.[modifiedby]
		,a.[transactioncurrencyid]
		,a.[statecodename]
		,a.[xjp_businessunitid]
		,a.[createdby]
		,a.[modifiedonbehalfbyname]
		,a.[statecode]
		,a.[versionnumber]
		,a.[createdon]
		,a.[xjp_locking]
		,a.[owneridtype]
		,a.[modifiedonbehalfbyyominame]
		,a.[xjp_stockidname]
		,a.[xjp_vehiclecostinputid]
		,a.[xjp_stockid]
		,a.[xjp_landedcostid]
		,a.[overriddencreatedon]
		,a.[createdonbehalfbyname]
		,a.[owneridname]
		,a.[exchangerate]
		,a.[owninguser]
		,a.[statuscodename]
		,a.[owningbusinessunit]
		,a.[timezoneruleversionnumber]
		,a.[xjp_vehiclecostinputdetailid]
		,a.[xjp_parentbusinessunitid]
		,a.[owningteam]
		,a.[transactioncurrencyidname]
		,a.[xjp_businessunitidname]
		,a.[xjp_amount]
		,a.[createdonbehalfby]
		,a.[xjp_vehiclecostinputdetail]
		,a.[xjp_landedcostidname]
		,a.[owneridyominame]
		,a.[createdbyyominame]
		,a.[utcconversiontimezonecode]
		,a.[DealerCode]
		,a.[SourceType]
		,a.[RowStatus]
		,a.[LastSyncDate]
		, b.msdyn_companycode    
	FROM CRM_xjp_vehiclecostinputdetail a  WITH(NOLOCK)   
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
	ON B.businessunitid = a.xjp_businessunitid   
	{0}
) as VWI_CRM_xjp_vehiclecostinputdetail