SELECT 
      ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
      ,[company]
      ,[businessunitcode]
      ,[xts_parentbusinessunitid]
      ,[versionnumber]
      ,[createdon]
      ,[statuscodename]
      ,[xts_locationidname]
      ,[xts_status]
      ,[xts_customerid]
      ,[ownerid]
      ,[modifiedbyyominame]
      ,[owneridtype]
      ,[xts_vehicledeliveryplace]
      ,[processid]
      ,[xts_personinchargeid]
      ,[xjp_recognizedmodelidname]
      ,[owningbusinessunit]
      ,[modifiedbyname]
      ,[xts_platenumber]
      ,[xts_businessunitidname]
      ,[xts_vehiclemodelidname]
      ,[owneridname]
      ,[overriddencreatedon]
      ,[xts_vehiclemodelid]
      ,[createdonbehalfbyyominame]
      ,[modifiedonbehalfby]
      ,[statuscode]
      ,[xjp_mileageexchangedate]
      ,[xts_customeridyominame]
      ,[xts_vehicletransactionhistoryid]
      ,[xts_usedvehicleexteriorcoloridname]
      ,[xts_productidname]
      ,[xts_usedvehicleexteriorcolorid]
      ,[statecode]
      ,[xts_driver]
      ,[timezoneruleversionnumber]
      ,[xts_mileage]
      ,[xts_customercontactidname]
      ,[xts_customercontactidyominame]
      ,[xts_customercontactid]
      ,[xts_customernumber]
      ,[xts_usedvehicledeliveryorderid]
      ,[traversedpath]
      ,[createdonbehalfbyname]
      ,[xts_personinchargeidname]
      ,[xts_productid]
      ,[xts_locking]
      ,[createdby]
      ,[utcconversiontimezonecode]
      ,[xts_businessunitid]
      ,[xjp_recognizedmodelid]
      ,[xts_statusname]
      ,[xts_handling]
      ,[modifiedon]
      ,[importsequencenumber]
      ,[owneridyominame]
      ,[xjp_servicestoreid]
      ,[xjp_mileagebeforeexchange]
      ,[xts_customeridname]
      ,[xts_transactiondate]
      ,[xts_siteid]
      ,[createdbyname]
      ,[owningteam]
      ,[modifiedonbehalfbyname]
      ,[xjp_servicestoreidname]
      ,[stageid]
      ,[xts_usedvehiclesalesorderid]
      ,[xts_vehicledeliveryplacename]
      ,[xts_warehouseidname]
      ,[xts_customerlookupname]
      ,[xts_vehicletransactionhistoryidname]
      ,[xts_locationid]
      ,[createdonbehalfby]
      ,[modifiedby]
      ,[xts_customerlookuptype]
      ,[xts_vehicleidentificationnumber]
      ,[createdbyyominame]
      ,[owninguser]
      ,[xts_stockid]
      ,[xts_stockidname]
      ,[xts_parentbusinessunitidname]
      ,[xjp_productionyearjapan]
      ,[xts_vehicledeliverynumber]
      ,[xts_usedvehiclesalesorderidname]
      ,[modifiedonbehalfbyyominame]
      ,[xts_siteidname]
      ,[xts_warehouseid]
      ,[xts_handlingname]
      ,[statecodename]
      ,[xts_ownerid]
      ,[xts_owneridname]
      ,[xts_exteriorcolor]
      ,[msdyn_companycode]
FROM (
	SELECT 
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.* 
        , b.msdyn_companycode
    FROM CRM_xts_usedvehicledeliveryorder a WITH(NOLOCK)
    LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
    WHERE xts_usedvehicledeliveryorderid = @Id
) VWI_CRM_xts_usedvehicledeliveryorder
