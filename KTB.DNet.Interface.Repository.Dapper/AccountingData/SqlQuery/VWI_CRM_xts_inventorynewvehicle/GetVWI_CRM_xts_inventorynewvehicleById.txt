SELECT 
    ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	,businessunitcode
	,xts_lastvehicleorderidname
	,xts_lastvehicleorderid
	,xjp_nitrogenoxidesunit
	,xts_vehicleexteriorcoloridname
	,xts_installedaccessories
	,xjp_lightvehiclecategoryname
	,modifiedon
	,xjp_completeinspectionissuedate1
	,overriddencreatedon
	,xts_receivingdate
	,xjp_stocknumberreferenceid
	,statuscodename
	,xts_width
	,xts_receivingprocess
	,transactioncurrencyid
	,modifiedbyyominame
	,xjp_lastrecyclingissuecategoryname
	,xjp_bodyshapeid
	,xjp_shipmentdestination
	,xjp_scheduledarrivaldate
	,xts_purchasediscount
	,xts_vehicleinteriorcolorid
	,xts_mainfueltypeidname
	,transactioncurrencyidname
	,xjp_recyclingticketnumber
	,xts_chassismodel
	,xts_departmentidname
	,ktb_iskaroseriname
	,xjp_nitrogenoxides
	,xts_totallandedcost
	,ktb_beginingbalance
	,xts_totalvalue
	,ktb_caroseriesamount_base
	,owningbusinessunit
	,modifiedbyname
	,xjp_lastrecyclingdepositdate
	,xts_inventorynewvehicleid
	,xts_locationid
	,xts_keynumber
	,statuscode
	,xts_productdescription
	,xts_warehouseidname
	,xjp_completeinspectionexpirydate2
	,ktb_vehiclecategoryidname
	,xjp_particulatematerialunit
	,xjp_suitabilityforabusiness
	,xts_remarks
	,xts_configurationidname
	,xts_totallandedcost_base
	,xjp_vehicleconsumptiontaxamount_base
	,xts_vehicleexteriorcolorid
	,xts_frontfrontaxleweight
	,xts_styleid
	,statecodename
	,xts_enginevolume
	,xts_secondfueltypeidname
	,xjp_registrationdatejapan
	,xts_installedaccessories_base
	,ktb_beginingbalancename
	,xts_vehicleidentificationid
	,xts_purchasediscount_base
	,xts_reasoncodeid
	,createdon
	,xts_classificationnumber
	,xjp_confirmedarrivalscheduledate
	,xjp_lastrecyclingissuecategory
	,xjp_grossweight2
	,ktb_vehiclecategoryid
	,xjp_completeinspectioncertificatenumber2
	,ktb_purchaseorderdate
	,ktb_dealeralokasiidname
	,createdonbehalfby
	,ktb_caroseriesamount
	,xjp_registrationmodel
	,xts_vehiclespecificationidname
	,xts_vehicleidentificationidname
	,xts_serialid
	,xts_productid
	,owneridyominame
	,modifiedby
	,timezoneruleversionnumber
	,xjp_maximumload1
	,ktb_vehiclecolorname
	,xjp_variousconsumptiontaxamount
	,xts_mainfueltypeid
	,modifiedonbehalfby
	,xts_madeinid
	,xjp_suitabilityforbusiness
	,xjp_purchasecategoryname
	,ktb_vehicledescription
	,owningteam
	,xts_totalvalue_base
	,xts_scheduledshipmentdate
	,xts_serviceandcostinspection_base
	,xts_rearrearaxleweight
	,ktb_accessoriesid
	,xjp_actualreceivedate
	,owninguser
	,xts_departmentid
	,xjp_bodyworkclassificationcategoryname
	,xjp_purchaseconsumptiontaxid
	,xts_height
	,xjp_stockaddress
	,xts_visibility
	,owneridtype
	,xts_enginenumber
	,xjp_preliminaryinspectiondate
	,ktb_dealeralokasiid
	,xjp_pocancellationdatelimit
	,xts_chassisnumber
	,xts_productionyear
	,xjp_lastinitialassessmentid
	,owneridname
	,ktb_iskaroseri
	,modifiedonbehalfbyname
	,createdonbehalfbyyominame
	,xjp_enginemodel
	,ktb_vehiclemodelid
	,xts_generation
	,xjp_lastinitialassessmentidname
	,xts_stocknumber
	,xjp_emissionpreventiondevice
	,xts_purchaseprice_base
	,ktb_vendoridname
	,xts_siteid
	,exchangerate
	,xts_vehiclespecificationid
	,xts_productfamily
	,xjp_capacity2
	,xjp_capacity1
	,xjp_completeinspectionissuedate2
	,xts_weight
	,xjp_idempotentmessage
	,xts_length
	,xts_frontrearaxleweight
	,xts_productidname
	,xjp_maximumload2
	,xts_configurationid
	,xts_dmsreferencenumber
	,xts_warehouseid
	,ktb_accessoriesidname
	,ownerid
	,xts_serviceandcostinspection
	,xjp_cartype
	,ktb_vendorid
	,createdonbehalfbyname
	,xts_frombusinessunitid
	,xjp_particulatematerial
	,xts_ribbondata
	,xts_rearfrontaxleweight
	,xts_tobusinessunitid
	,createdbyname
	,xjp_purchasecategory
	,xts_businessunitidname
	,statecode
	,xts_siteidname
	,xts_locationidname
	,modifiedonbehalfbyyominame
	,createdby
	,xts_serialidname
	,xjp_numberofsideairbag
	,xjp_bodyworkclassificationcategory
	,xjp_enginetype
	,xjp_suitabilityforabusinessname
	,xjp_preliminaryinspectionexpense_base
	,xts_referencenumber
	,xjp_bodyshapeidname
	,xts_vehicleinteriorcoloridname
	,xjp_newvehiclesalesorderidname
	,xjp_enginetypename
	,utcconversiontimezonecode
	,xjp_preliminaryinspectionexpense
	,xts_secondfueltypeid
	,xts_receivingprocessname
	,xjp_newvehiclesalesorderid
	,ktb_applicationno
	,xts_visibilityname
	,xts_frombusinessunitidname
	,importsequencenumber
	,xts_locking
	,xts_styleidname
	,xjp_purchaseconsumptiontaxidname
	,xjp_shipmentdate
	,xjp_totalconsumptiontaxamount_base
	,xjp_shipmentplace
	,xjp_vehicleconsumptiontaxamount
	,versionnumber
	,ktb_vehiclemodelidname
	,xts_businessunitid
	,xts_modelspecificationnumber
	,xjp_variousconsumptiontaxamount_base
	,xts_issueddate
	,xjp_totalconsumptiontaxamount
	,xjp_grossweight1
	,xjp_completeinspectionexpirydate
	,xjp_completeinspectioncertificatenumber1
	,xts_tobusinessunitidname
	,xjp_completeinspectiondate
	,xts_madeinidname
	,createdbyyominame
	,xjp_usageid
	,xjp_lightvehiclecategory
	,xjp_suitabilityforbusinessname
	,xts_purchaseprice
	,xjp_stocknumberreferenceidname
	,xjp_usageidname
	,xjp_productionplant
	,xts_reasoncodeidname
	,ktb_description
	,RowStatus
	,ktb_atd
	,ktb_etd
	,ktb_eta
	,ktb_statusinterfacednetname
	,ktb_statusinterfacednet
	,ktb_chassisexternalname
	,ktb_interfaceexceptionmessage
	,ktb_chassisexternal
	,ktb_fakturdate
	,ktb_revisionstatusname
	,ktb_validationdate
	,ktb_printeddate
	,ktb_revisionstatus
	,ktb_fakturnumber
	,ktb_confirmdate
	,ktb_fakturstatusname
	,ktb_fakturstatus
	,ktb_kondisikendaraan
FROM (
	SELECT  
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.* 
        , b.msdyn_companycode
    FROM CRM_xts_inventorynewvehicle a WITH(NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
   WHERE xts_inventorynewvehicleid = @Id
) VWI_CRM_xts_inventorynewvehicle 
