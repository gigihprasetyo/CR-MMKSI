SELECT 
    ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
    , company
    , businessunitcode
    , xjp_requestingbusinessunitidname
    , xjp_endoflifevehicle
    , xjp_parkingspacecertificationcollectedby
    , xjp_stockstoreidname
    , xjp_garageaddresssamewithusername
    , xjp_agencyautomobiletaxpaymentname
    , xjp_othercarkatakana
    , xjp_garagecityid
    , xjp_cardeliverydesireddate
    , xjp_lightcharacterplatetypename
    , overriddencreatedon
    , xjp_usertype
    , xjp_stockinventorynewvehicleid
    , xjp_parentbusinessunitdescription
    , xjp_usercityid
    , xjp_pattern
    , xjp_actualautomobileacquisitiontaxamount_base
    , importsequencenumber
    , xjp_owneridname
    , xjp_productionyear
    , xjp_registrationtaxcategory
    , xjp_registrationcategoryname
    , xjp_stockstoreid
    , xjp_userdescription
    , xjp_whereaboutsproof
    , xjp_taxdeclarationbook
    , xjp_compulsoryinsuranceapplicationdate
    , xjp_receivingbusinessunitid
    , xjp_vehiclespecificationidname
    , xjp_garageaddress2
    , xjp_leasedocument
    , statecodename
    , xjp_othercarnumber
    , xjp_businessunitidname
    , xjp_customeridyominame
    , xjp_registrationpurposename
    , xjp_completeinspectionexpiredname
    , xjp_agencyacquisitiontaxpaymentname
    , xjp_applicationregistrationofficeidname
    , xjp_endoflifevehiclename
    , xjp_garageapplicationsamewithusername
    , xjp_ownerzipcode
    , xjp_taxablemisccharge_base
    , xjp_ownercityidname
    , xjp_garageapplicationvillageandstreetidname
    , xjp_automobiletaxamount
    , xjp_othercarclassification
    , xjp_garageapplicationvillageandstreetid
    , xjp_vehiclespecificationid
    , xjp_ownernumber
    , xjp_garageprovinceidname
    , xjp_vehiclemodelidname
    , xjp_otherpartyregistrationtypename
    , xjp_registrationresultofficeid
    , xjp_handlingname
    , xjp_otherpartyregistrationtype
    , xjp_patternname
    , xjp_garageapplicationsamewithuser
    , xjp_vehiclemodelid
    , xjp_creditcompanyid
    , xjp_currentplatenumber
    , xjp_miscellaneouschargeconsumptiontax_base
    , xjp_vehicleconsumptiontax
    , xjp_documentcompletiondate
    , xjp_requiredservice
    , xjp_remodelingname
    , xjp_customerid
    , xjp_peoplewithdisabilities
    , xjp_personinchargeid
    , xjp_paymentmethodid
    , xjp_requestplatenumber
    , versionnumber
    , xjp_garageapplicationrequired
    , xjp_salesordernumber
    , xjp_vehicleconsumptiontax_base
    , xjp_residentscard
    , xjp_othercarregistrationofficeid
    , xjp_parentbusinessunitidname
    , xjp_grandtotal
    , xjp_stocknumberlookupname
    , modifiedonbehalfbyname
    , xjp_userrepresentative
    , xjp_documentexpireddate
    , xjp_stockinventorynewvehicleidname
    , createdbyyominame
    , xjp_garageaddress1
    , xjp_ownerdescription
    , xjp_insurancecompanyidname
    , xjp_uservillageandaddressid
    , xjp_weighttaxamount_base
    , xjp_ownerprovinceid
    , xjp_registrationreceiptdate
    , xjp_insurancecompanycode
    , owningbusinessunit
    , xjp_garageaddress3
    , xjp_userproxydocumentcollectedbyname
    , xjp_ownershipcategoryname
    , xjp_vehicleinspectionexpirationdate
    , xjp_uservillageandaddressidname
    , xjp_usedvehicletaxreductioncategoryname
    , xjp_compulsoryinsuranceapplymethod
    , xjp_productid
    , xjp_caliamount_base
    , xjp_requestedclassification
    , xjp_ownervillageandaddressid
    , xjp_accessoriesacquisitiontaxamount
    , xjp_agencyautomobiletaxpayment
    , xjp_registrationmethodname
    , xjp_taxpayercategory
    , xjp_actualautomobileacquisitiontaxamount
    , transactioncurrencyidname
    , xjp_requestedplatenumber
    , xjp_useraddress2
    , xjp_registrationscheduleddate
    , xjp_validperiod
    , xjp_governmentoffice
    , xjp_referencenumber
    , xjp_customeridname
    , createdonbehalfbyname
    , xjp_parkingplaceownersamewithuser
    , xjp_vehiclespecificnumber
    , xjp_garageaddresssamewithuser
    , xjp_userid
    , xjp_taxpayercategoryname
    , xjp_agencycalipaymentname
    , transactioncurrencyid
    , xjp_registrationtype
    , xjp_agencyhandlingname
    , xjp_nontaxablemiscellaneouscharge
    , xjp_requestedpersonincharge
    , owneridname
    , xjp_requestedbusinessunitidname
    , xjp_vehicleinspectionexpireddate
    , xjp_miscellaneouschargetotal_base
    , xjp_parkingplaceownersamewithusername
    , xjp_height
    , xjp_companyvehiclename
    , xjp_userproxydocumentcollectedby
    , xjp_companyvehicle
    , xjp_agencyweighttaxpaymentname
    , xjp_acquisitiontaxtotalamount_base
    , xjp_osscoloridname
    , xjp_lightvehiclename
    , xjp_platenumbersegment1idname
    , exchangerate
    , xjp_garageapplicationrequiredname
    , xjp_miscellaneouschargeconsumptiontax
    , xjp_accessoriesconsumptiontax_base
    , xjp_parkingplaceprovinceid
    , xjp_registrationdesireddate
    , xjp_agencyacquisitiontaxpayment
    , xjp_registrationcategory
    , xjp_registrationcardeliveryagencyname
    , xjp_others
    , xjp_garageaddress
    , xjp_actualweighttaxamount
    , xjp_insuranceperiod
    , xjp_compulsoryinsurancecertificatenumber
    , xjp_physicallyhandicappedpersonpocketbook
    , xjp_registrationdocumentnumber
    , xjp_accessoriesacquisitiontaxamount_base
    , xjp_currentplatenumbersegment4
    , xjp_userphone
    , xjp_ownershippatternname
    , xjp_taxablemisccharge
    , xjp_receivingbusinessunitidname
    , xjp_ownershipcategory
    , xjp_locking
    , xjp_nontaxablemiscellaneouscharge_base
    , xjp_ossregistrationstatus
    , xjp_useraddress4
    , xjp_grandtotal_base
    , xjp_useraddress1
    , xjp_parkingspacecertificationcollectedbyname
    , xjp_osscolorid
    , xjp_parkingplaceprovinceidname
    , xjp_platenumbersegment4
    , xjp_owneraddress4
    , createdon
    , xjp_parkingplaceaddress
    , xjp_platenumbersegment2
    , xjp_owneraddress1
    , xjp_owneraddress2
    , xjp_owneraddress3
    , xjp_garageaddress4
    , xjp_usertypename
    , xjp_businessunitid
    , xjp_classificationnumber
    , xjp_registrationdocumentrefid
    , xjp_ownertype
    , xjp_ownershippattern
    , xjp_usagecategory
    , xjp_customernumber
    , xjp_round
    , xjp_currentplatenumbersegment1id
    , xjp_registrationresultofficeidname
    , xjp_compulsoryautomobileliabilityinsurance
    , xjp_premisesvehiclename
    , xjp_creditcompanyidyominame
    , xjp_registrationrequestnumber
    , xjp_certificationofparkingspace
    , xjp_width
    , xjp_actualautomobiletaxamount
    , xjp_governmentofficename
    , xjp_ownerid
    , xjp_recyclingticket
    , xjp_registrationtypename
    , xjp_actualautomobiletaxamount_base
    , createdbyname
    , xjp_registrationresultsdate
    , xjp_garageapplicationcityidname
    , xjp_parentbusinessunitid
    , xjp_scheduleddeliverydate
    , statecode
    , xjp_productidname
    , statuscode
    , xjp_ownerrepresentativedescription
    , xjp_bringingindate
    , xjp_vehicleidentificationnumber
    , xjp_remodeling
    , xjp_vehicleacquisitiontaxamount
    , xjp_productconfigurationid
    , xjp_peoplewithdisabilitiesname
    , timezoneruleversionnumber
    , modifiedonbehalfbyyominame
    , xjp_creditcompanyidname
    , xjp_writtenreportmodel
    , xjp_productinteriorcoloridname
    , statuscodename
    , owninguser
    , xjp_requestplatenumbername
    , xjp_parkingplacecertificatenumber
    , xjp_stockinventoryusedvehicleid
    , xjp_consumptiontaxamount_base
    , xjp_registrationreferencenumber
    , xjp_productionyearjapan
    , modifiedbyname
    , xjp_requiredservicename
    , owneridtype
    , xjp_registrationmethod
    , xjp_garageapplicationprovinceidname
    , xjp_miscellaneouschargecollectiondate
    , xjp_spaceforcorrespondence
    , xjp_documentcompletion
    , xjp_officiallyregisteredseal
    , xjp_requestingbusinessunitid
    , xjp_transactiondate
    , xjp_accessoriesconsumptiontax
    , xjp_productexteriorcoloridname
    , xjp_registrationdocumentrefidname
    , xjp_ownerphone
    , xjp_premisesvehicle
    , xjp_taxreductioncategory
    , xjp_agencyweighttaxpayment
    , xjp_ownercityid
    , xjp_completeinspectionexpired
    , xjp_recognizedmodelidname
    , xjp_owneridyominame
    , xjp_personinchargeidname
    , xjp_lastregistrationpaymentid
    , xjp_requestedbusinessunitid
    , xjp_compulsoryinsuranceholder
    , xjp_usercityidname
    , xjp_documentcompletionname
    , createdonbehalfbyyominame
    , xjp_lastregistrationpaymentidname
    , xjp_agencyhandling
    , ownerid
    , xjp_scheduleshipmentdate
    , xjp_currentplatenumbersegment3
    , xjp_requestednumber
    , xjp_agencyregistrationstatusname
    , modifiedonbehalfby
    , xjp_productconfigurationidname
    , owningteam
    , xjp_registrationresultplatenumber
    , xjp_applicationregistrationofficeid
    , xjp_lightcharacter
    , xjp_useridname
    , xjp_button
    , xjp_taxreductioncategoryname
    , xjp_userprovinceid
    , xjp_garagevillageandstreetidname
    , owneridyominame
    , xjp_useridyominame
    , xjp_requestedrequestedbusinessunitincharge
    , xjp_garageapplicationcityid
    , xjp_customerdescription
    , xjp_registrationsendingdate
    , xjp_othercarplatenumber
    , xjp_weighttaxamount
    , xjp_productstyleidname
    , xjp_parkingplaceownersamewiththeusername
    , xjp_proxydocumentcollectedby
    , xjp_currentplatenumbersegment2
    , xjp_length
    , xjp_consumptiontaxamount
    , xjp_reject
    , xjp_receivingdate
    , xjp_userrepresentativedescription
    , xjp_useraddress3
    , modifiedby
    , xjp_insurancecompanyid
    , xjp_currentplatenumbersegment1idname
    , xjp_requestedkatakana
    , xjp_proxydocumentcollectedbyname
    , xjp_garagevillageandstreetid
    , xjp_tempotherids
    , xjp_usagecategoryname
    , xjp_acquisitiontaxtotalamount
    , xjp_compulsoryinsuranceapplymethodname
    , xjp_vehicleacquisitiontaxamount_base
    , xjp_rentalvehiclename
    , xjp_userpostalcode
    , xjp_theletterofattorney
    , xjp_productexteriorcolorid
    , xjp_agencyregistrationstatus
    , xjp_usedvehicletaxreductioncategory
    , xjp_ownerhaveothercar
    , xjp_documentreturndate
    , xjp_othercarregistrationofficeidname
    , xjp_ownerrepresentative
    , utcconversiontimezonecode
    , xjp_garageapplicationprovinceid
    , xjp_compulsoryinsuranceholdername
    , xjp_ossregistrationstatusname
    , xjp_documentreceiptdate
    , xjp_productinteriorcolorid
    , xjp_modelspecification
    , xjp_invoiceddate
    , xjp_registrationrequestid
    , xjp_caliamount
    , xjp_registrationresultperiod
    , xjp_platenumbersegment3
    , xjp_userprovinceidname
    , xjp_miscellaneouschargetotal
    , xjp_rentalvehicle
    , xjp_ownervillageandaddressidname
    , xjp_registrationcardeliveryagency
    , xjp_ownerprovinceidname
    , xjp_agencycalipayment
    , xjp_automobiletaxamount_base
    , xjp_registrationpurpose
    , xjp_lightcharacterplatetype
    , xjp_handling
    , xjp_recognizedmodelid
    , xjp_ownerhaveothercarname
    , xjp_rejectname
    , xjp_statusname
    , xjp_lightvehicle
    , xjp_paymentmethodidname
    , xjp_actualweighttaxamount_base
    , xjp_garageprovinceid
    , xjp_stocknumberlookuptype
    , modifiedon
    , modifiedbyyominame
    , createdonbehalfby
    , xjp_requestedplatenumberproof
    , xjp_status
    , xjp_platenumbersegment1id
    , xjp_garagecityidname
    , createdby
    , xjp_ownertypename
    , xjp_ribbonsource
    , xjp_stockinventoryusedvehicleidname
    , xjp_parkingplaceownersamewiththeuser
    , xjp_productstyleid
    , msdyn_companycode
FROM (
	SELECT 
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.* 
        , b.msdyn_companycode
    FROM CRM_xjp_registrationrequest a WITH(NOLOCK)
    LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xjp_businessunitid
    where xjp_registrationrequestid = @Id
) as VWI_CRM_xjp_registrationrequest 