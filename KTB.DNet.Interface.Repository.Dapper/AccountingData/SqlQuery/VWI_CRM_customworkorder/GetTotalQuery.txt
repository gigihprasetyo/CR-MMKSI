SELECT 
	COUNT(1)
from (
    select
	      b.ktb_bucompany company
        , b.ktb_dealercode businessunitcode
        , a.xts_contactpersonid
        , a.xts_vehiclesizeclassid
        , a.ktb_countedprint
        , a.xts_actualservicestartdateandtime
        , a.xts_totalpartsamount
        , a.xts_esttotaltaxamount_base
        , a.ktb_vehiclestatename
        , a.xts_esttotalothersalestaxamount_base
        , a.xts_grandtotalamount_base
        , a.ktb_say
        , a.xts_esttotalworktaxamount_base
        , a.xts_estgrandtotalamount
        , a.xts_lastmileage
        , a.ktb_svcincominginterfacestatusname
        , a.xts_billtocustomeridyominame
        , a.xts_invoiced
        , a.xts_totalpartstaxamount_base
        , a.xts_totalcostamount_base
        , a.xts_workorder
        , a.ktb_workordermemo
        , a.xts_scheduledservicestartdateandtime
        , a.xts_estgrandtotalamount_base
        , a.xts_handling
        , a.xts_originaloutsorcereferencelookuptype
        , a.xts_totalothersalesnotallocated_base
        , a.versionnumber
        , a.xts_grandtotalnotallocated
        , a.xts_queuestatus
        , a.xjp_originaloutsorcereferencepdiid
        , a.ktb_saleschannelidname
        , a.xts_esttotalpartstaxamount_base
        , a.xts_productsegment3id
        , a.ktb_wodate
        , a.xts_billtocustomerid
        , a.xts_totalpaymentamount_base
        , a.xts_billtocustomeridname
        , a.xts_customernumber
        , a.xts_esttotalpartstaxamount
        , a.xts_productsegment1id
        , a.ktb_liststatusinterface
        , a.ktb_ordertypetranstype
        , a.xts_workorderstatus
        , a.ktb_totalpartamount
        , a.xts_actualservicefinishdateandtime
        , a.xts_productdescription
        , a.transactioncurrencyid
        , a.xts_totalbaseamount_base
        , a.xts_esttotaltaxamount
        , a.xts_originaloutsorcereferenceoutsourcewoid
        , a.xts_totalmiscchargebasenotallocated
        , a.xts_isworkorderform
        , a.xts_esttotalpartsamount
        , a.xts_esttotalpartsbaseamount_base
        , a.xts_totalwithholdingtaxnotallocated
        , a.xts_dimension10idname
        , a.xts_totaltaxamount
        , a.exchangerate
        , a.xts_balance
        , a.modifiedonbehalfbyyominame
        , a.xts_pickupaddress1
        , a.xts_totalpartsbaseallocated
        , a.xts_workorderid
        , a.xts_totalpartstaxnotallocated_base
        , a.xts_totalmiscchargeallocated_base
        , a.xts_claimapprovalnumber
        , a.xts_totalpartsbaseamount
        , a.xts_grandtotalnotallocated_base
        , a.ktb_paneldescription
        , a.xts_downpaymentamount
        , a.xts_serviceadvisorid
        , a.xts_siteid
        , a.ktb_validatorhandling
        , a.xts_contactpersonphone
        , a.xts_dimension8idname
        , a.ktb_isinsurance
        , a.createdon
        , a.xts_invoicepostingdate
        , a.xts_totalworktaxamount
        , a.xts_totalothersalesallocated
        , a.ktb_totalserviceamount
        , a.xts_deliveryaddress4
        , a.xts_servicecategoryidname
        , a.xts_currentmileage
        , a.xts_claimstatus
        , a.xts_totalpartsbasenotallocated
        , a.xts_chassisnumber
        , a.xts_totalothersalestaxamount
        , a.xts_totalpartstaxnotallocated
        , a.ktb_isinterfaced
        , a.xts_historymileage
        , a.xts_totalworkbasenotallocated_base
        , a.xts_grandtotalamount
        , a.statecode
        , a.statuscode
        , a.xts_totalothersalesbaseamount
        , a.xts_totalpartstaxamount
        , a.xts_totalworkamount
        , a.xts_scheduledarrivaldateandtime
        , a.ktb_statusinterface
        , a.xts_transactiondate
        , a.owninguser
        , a.ktb_isfreebilltocustomer
        , a.xts_totalmiscchargetaxnotallocated_base
        , a.xts_esttotalbaseamount_base
        , a.xts_totalpartsamount_base
        , a.xts_downpaymentispaidname
        , a.ktb_contactmobilephonenumber
        , a.xts_vehicleidentificationid
        , a.xts_totalpartsnotallocated_base
        , a.xts_totalpartstaxallocated
        , a.xts_esttotalbaseamount
        , a.xts_exchangeratetypeid
        , a.xts_scheduledservicefinishdateandtime
        , a.ktb_workorderdescription
        , a.xts_totalpartsbaseamount_base
        , a.xts_esttotalothersalesbaseamount
        , a.xts_manufacturername
        , a.xts_parentbusinessunitid
        , a.xts_deliveryaddress1
        , a.xts_esttotalpartsbaseamount
        , a.xts_totalothersalesnotallocated
        , a.xts_totaltaxamount_base
        , a.xts_totalpartsnotallocated
        , a.xts_referralname
        , a.xts_totalcostamount
        , a.ktb_totaloilamount
        , a.utcconversiontimezonecode
        , a.xts_totalpartsbasenotallocated_base
        , a.ktb_contactid
        , a.modifiedon
        , a.xts_scheduledfinishdateandtime
        , a.xts_dimension2id
        , a.xts_totalbaseamount
        , a.ktb_dnetidwotype
        , a.xts_originaloutsorcereferencesvcinstructionidname
        , a.xts_esttotalpartsamount_base
        , a.ktb_grandtotalinformationdetail
        , b.msdyn_companycode
    FROM CRM_xts_workorder a WITH(NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
    {0}
) VWI_CRM_customworkorder
