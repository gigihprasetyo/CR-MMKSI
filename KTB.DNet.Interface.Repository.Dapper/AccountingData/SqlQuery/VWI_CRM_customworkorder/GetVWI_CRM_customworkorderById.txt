SELECT 
	 ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	, company
	, businessunitcode
	, xts_contactpersonid
	, xts_vehiclesizeclassid
	, ktb_countedprint
	, xts_actualservicestartdateandtime
	, xts_totalpartsamount
	, xts_esttotaltaxamount_base
	, ktb_vehiclestatename
	, xts_esttotalothersalestaxamount_base
	, xts_grandtotalamount_base
	, ktb_say
	, xts_esttotalworktaxamount_base
	, xts_estgrandtotalamount
	, xts_lastmileage
	, ktb_svcincominginterfacestatusname
	, xts_billtocustomeridyominame
	, xts_invoiced
	, xts_totalpartstaxamount_base
	, xts_totalcostamount_base
	, xts_workorder
	, ktb_workordermemo
	, xts_scheduledservicestartdateandtime
	, xts_estgrandtotalamount_base
	, xts_handling
	, xts_originaloutsorcereferencelookuptype
	, xts_totalothersalesnotallocated_base
	, versionnumber
	, xts_grandtotalnotallocated
	, xts_queuestatus
	, xjp_originaloutsorcereferencepdiid
	, ktb_saleschannelidname
	, xts_esttotalpartstaxamount_base
	, xts_productsegment3id
	, ktb_wodate
	, xts_billtocustomerid
	, xts_totalpaymentamount_base
	, xts_billtocustomeridname
	, xts_customernumber
	, xts_esttotalpartstaxamount
	, xts_productsegment1id
	, ktb_liststatusinterface
	, ktb_ordertypetranstype
	, xts_workorderstatus
	, ktb_totalpartamount
	, xts_actualservicefinishdateandtime
	, xts_productdescription
	, transactioncurrencyid
	, xts_totalbaseamount_base
	, xts_esttotaltaxamount
	, xts_originaloutsorcereferenceoutsourcewoid
	, xts_totalmiscchargebasenotallocated
	, xts_isworkorderform
	, xts_esttotalpartsamount
	, xts_esttotalpartsbaseamount_base
	, xts_totalwithholdingtaxnotallocated
	, xts_dimension10idname
	, xts_totaltaxamount
	, exchangerate
	, xts_balance
	, modifiedonbehalfbyyominame
	, xts_pickupaddress1
	, xts_totalpartsbaseallocated
	, xts_workorderid
	, xts_totalpartstaxnotallocated_base
	, xts_totalmiscchargeallocated_base
	, xts_claimapprovalnumber
	, xts_totalpartsbaseamount
	, xts_grandtotalnotallocated_base
	, ktb_paneldescription
	, xts_downpaymentamount
	, xts_serviceadvisorid
	, xts_siteid
	, ktb_validatorhandling
	, xts_contactpersonphone
	, xts_dimension8idname
	, ktb_isinsurance
	, createdon
	, xts_invoicepostingdate
	, xts_totalworktaxamount
	, xts_totalothersalesallocated
	, ktb_totalserviceamount
	, xts_deliveryaddress4
	, xts_servicecategoryidname
	, xts_currentmileage
	, xts_claimstatus
	, xts_totalpartsbasenotallocated
	, xts_chassisnumber
	, xts_totalothersalestaxamount
	, xts_totalpartstaxnotallocated
	, ktb_isinterfaced
	, xts_historymileage
	, xts_totalworkbasenotallocated_base
	, xts_grandtotalamount
	, statecode
	, statuscode
	, xts_totalothersalesbaseamount
	, xts_totalpartstaxamount
	, xts_totalworkamount
	, xts_scheduledarrivaldateandtime
	, ktb_statusinterface
	, xts_transactiondate
	, owninguser
	, ktb_isfreebilltocustomer
	, xts_totalmiscchargetaxnotallocated_base
	, xts_esttotalbaseamount_base
	, xts_totalpartsamount_base
	, xts_downpaymentispaidname
	, ktb_contactmobilephonenumber
	, xts_vehicleidentificationid
	, xts_totalpartsnotallocated_base
	, xts_totalpartstaxallocated
	, xts_esttotalbaseamount
	, xts_exchangeratetypeid
	, xts_scheduledservicefinishdateandtime
	, ktb_workorderdescription
	, xts_totalpartsbaseamount_base
	, xts_esttotalothersalesbaseamount
	, xts_manufacturername
	, xts_parentbusinessunitid
	, xts_deliveryaddress1
	, xts_esttotalpartsbaseamount
	, xts_totalothersalesnotallocated
	, xts_totaltaxamount_base
	, xts_totalpartsnotallocated
	, xts_referralname
	, xts_totalcostamount
	, ktb_totaloilamount
	, utcconversiontimezonecode
	, xts_totalpartsbasenotallocated_base
	, ktb_contactid
	, modifiedon
	, xts_scheduledfinishdateandtime
	, xts_dimension2id
	, xts_totalbaseamount
	, ktb_dnetidwotype
	, xts_originaloutsorcereferencesvcinstructionidname
	, xts_esttotalpartsamount_base
	, ktb_grandtotalinformationdetail
	, msdyn_companycode
from (
    select
	      b.ktb_bucompany company
        , b.ktb_dealercode businessunitcode
        , a.xts_contactpersonid
        , a.xts_vehiclesizeclassid
        , a.ktb_countedprint
        , a.xts_actualservicestartdateandtime
        , a.xts_totalpartsamount
        , a.xts_esttotaltaxamount_base
        , a.ktb_vehiclestatename
        , a.xts_esttotalothersalestaxamount_base
        , a.xts_grandtotalamount_base
        , a.ktb_say
        , a.xts_esttotalworktaxamount_base
        , a.xts_estgrandtotalamount
        , a.xts_lastmileage
        , a.ktb_svcincominginterfacestatusname
        , a.xts_billtocustomeridyominame
        , a.xts_invoiced
        , a.xts_totalpartstaxamount_base
        , a.xts_totalcostamount_base
        , a.xts_workorder
        , a.ktb_workordermemo
        , a.xts_scheduledservicestartdateandtime
        , a.xts_estgrandtotalamount_base
        , a.xts_handling
        , a.xts_originaloutsorcereferencelookuptype
        , a.xts_totalothersalesnotallocated_base
        , a.versionnumber
        , a.xts_grandtotalnotallocated
        , a.xts_queuestatus
        , a.xjp_originaloutsorcereferencepdiid
        , a.ktb_saleschannelidname
        , a.xts_esttotalpartstaxamount_base
        , a.xts_productsegment3id
        , a.ktb_wodate
        , a.xts_billtocustomerid
        , a.xts_totalpaymentamount_base
        , a.xts_billtocustomeridname
        , a.xts_customernumber
        , a.xts_esttotalpartstaxamount
        , a.xts_productsegment1id
        , a.ktb_liststatusinterface
        , a.ktb_ordertypetranstype
        , a.xts_workorderstatus
        , a.ktb_totalpartamount
        , a.xts_actualservicefinishdateandtime
        , a.xts_productdescription
        , a.transactioncurrencyid
        , a.xts_totalbaseamount_base
        , a.xts_esttotaltaxamount
        , a.xts_originaloutsorcereferenceoutsourcewoid
        , a.xts_totalmiscchargebasenotallocated
        , a.xts_isworkorderform
        , a.xts_esttotalpartsamount
        , a.xts_esttotalpartsbaseamount_base
        , a.xts_totalwithholdingtaxnotallocated
        , a.xts_dimension10idname
        , a.xts_totaltaxamount
        , a.exchangerate
        , a.xts_balance
        , a.modifiedonbehalfbyyominame
        , a.xts_pickupaddress1
        , a.xts_totalpartsbaseallocated
        , a.xts_workorderid
        , a.xts_totalpartstaxnotallocated_base
        , a.xts_totalmiscchargeallocated_base
        , a.xts_claimapprovalnumber
        , a.xts_totalpartsbaseamount
        , a.xts_grandtotalnotallocated_base
        , a.ktb_paneldescription
        , a.xts_downpaymentamount
        , a.xts_serviceadvisorid
        , a.xts_siteid
        , a.ktb_validatorhandling
        , a.xts_contactpersonphone
        , a.xts_dimension8idname
        , a.ktb_isinsurance
        , a.createdon
        , a.xts_invoicepostingdate
        , a.xts_totalworktaxamount
        , a.xts_totalothersalesallocated
        , a.ktb_totalserviceamount
        , a.xts_deliveryaddress4
        , a.xts_servicecategoryidname
        , a.xts_currentmileage
        , a.xts_claimstatus
        , a.xts_totalpartsbasenotallocated
        , a.xts_chassisnumber
        , a.xts_totalothersalestaxamount
        , a.xts_totalpartstaxnotallocated
        , a.ktb_isinterfaced
        , a.xts_historymileage
        , a.xts_totalworkbasenotallocated_base
        , a.xts_grandtotalamount
        , a.statecode
        , a.statuscode
        , a.xts_totalothersalesbaseamount
        , a.xts_totalpartstaxamount
        , a.xts_totalworkamount
        , a.xts_scheduledarrivaldateandtime
        , a.ktb_statusinterface
        , a.xts_transactiondate
        , a.owninguser
        , a.ktb_isfreebilltocustomer
        , a.xts_totalmiscchargetaxnotallocated_base
        , a.xts_esttotalbaseamount_base
        , a.xts_totalpartsamount_base
        , a.xts_downpaymentispaidname
        , a.ktb_contactmobilephonenumber
        , a.xts_vehicleidentificationid
        , a.xts_totalpartsnotallocated_base
        , a.xts_totalpartstaxallocated
        , a.xts_esttotalbaseamount
        , a.xts_exchangeratetypeid
        , a.xts_scheduledservicefinishdateandtime
        , a.ktb_workorderdescription
        , a.xts_totalpartsbaseamount_base
        , a.xts_esttotalothersalesbaseamount
        , a.xts_manufacturername
        , a.xts_parentbusinessunitid
        , a.xts_deliveryaddress1
        , a.xts_esttotalpartsbaseamount
        , a.xts_totalothersalesnotallocated
        , a.xts_totaltaxamount_base
        , a.xts_totalpartsnotallocated
        , a.xts_referralname
        , a.xts_totalcostamount
        , a.ktb_totaloilamount
        , a.utcconversiontimezonecode
        , a.xts_totalpartsbasenotallocated_base
        , a.ktb_contactid
        , a.modifiedon
        , a.xts_scheduledfinishdateandtime
        , a.xts_dimension2id
        , a.xts_totalbaseamount
        , a.ktb_dnetidwotype
        , a.xts_originaloutsorcereferencesvcinstructionidname
        , a.xts_esttotalpartsamount_base
        , a.ktb_grandtotalinformationdetail
        , b.msdyn_companycode
    FROM CRM_xts_workorder a WITH(NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
    where xts_workorderid = @Id
) VWI_CRM_xts_workorder_1
