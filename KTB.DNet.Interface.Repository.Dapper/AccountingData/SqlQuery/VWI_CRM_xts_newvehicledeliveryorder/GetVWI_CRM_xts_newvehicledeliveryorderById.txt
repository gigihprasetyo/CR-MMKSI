SELECT 
	ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
	,company
	,businessunitcode
	,xts_stockidname
	,xts_parentbusinessunitid
	,versionnumber
	,xts_delivertocustomernumber
	,createdon
	,xjp_billtocustomerid
	,xts_productconfigurationid
	,xjp_idempotentmessage
	,xts_eventdata
	,statuscodename
	,xts_productinteriorcolorid
	,xts_status
	,xts_customerid
	,modifiedbyyominame
	,owneridtype
	,ktb_perlengkapanstandarid
	,xts_log
	,xts_cancellednvdoreferenceidname
	,xts_personinchargeid
	,xts_financingcompanyid
	,xts_notes
	,xts_financingcompanyidname
	,modifiedbyname
	,xts_platenumber
	,xts_deliveryaddressidname
	,xjp_platenumbersegment4
	,ktb_vehicledescription
	,owneridname
	,ktb_vehiclecolorname
	,overriddencreatedon
	,xjp_platenumbersegment2
	,xts_delivertocustomeridname
	,xts_type
	,xts_deliveryaddressid
	,modifiedonbehalfby
	,xts_customeridyominame
	,xts_newvehiclesalesorderid
	,xts_ribboneventdata
	,ktb_bypassdp
	,xts_productidname
	,xts_newvehicledeliveryorderid
	,xts_financingpurchaseordernumber
	,statecode
	,xts_driver
	,timezoneruleversionnumber
	,xjp_platenumbersegment1id
	,xts_delivertocustomeridyominame
	,xts_warehouseidname
	,xts_productstyleid
	,xts_cancellednvdoreferenceid
	,xts_locking
	,xts_handling
	,xts_customernumber
	,xjp_platenumbersegment3
	,xts_financingcompanyidyominame
	,xts_deliverydate
	,traversedpath
	,createdonbehalfbyname
	,xjp_billtocustomernumber
	,xts_newvehiclesalesorderidname
	,xts_productexteriorcolorid
	,createdonbehalfby
	,utcconversiontimezonecode
	,xts_statusname
	,xts_typename
	,xjp_billtocustomeridname
	,ownerid
	,modifiedon
	,importsequencenumber
	,owneridyominame
	,ktb_alamatkirim
	,ktb_vehiclemodelid
	,xts_personinchargeidname
	,xts_customeridname
	,xts_siteid
	,processid
	,createdbyname
	,ktb_vehiclecategoryid
	,xts_businessunitid
	,modifiedonbehalfbyname
	,xts_productexteriorcoloridname
	,xts_productconfigurationidname
	,stageid
	,xts_handlingname
	,ktb_tanggalpkt
	,xjp_platenumbersegment1idname
	,xts_productid
	,owningteam
	,createdby
	,modifiedby
	,ktb_perlengkapanstandaridname
	,ktb_bypassdpname
	,ktb_vehiclemodelidname
	,createdbyyominame
	,owninguser
	,createdonbehalfbyyominame
	,xts_stockid
	,xts_locationid
	,ktb_vehiclecategoryidname
	,xts_parentbusinessunitidname
	,xts_productinteriorcoloridname
	,ktb_interfaceexceptionmessage
	,xjp_billtocustomeridyominame
	,statuscode
	,modifiedonbehalfbyyominame
	,xts_siteidname
	,xts_warehouseid
	,ktb_dealerinternalnumber
	,xts_delivertocustomerid
	,xts_locationidname
	,xts_newvehicledeliveryordernumber
	,xts_productdescription
	,statecodename
	,xts_businessunitidname
	,owningbusinessunit
	,xts_productstyleidname
	,RowStatus
	,ktb_skenariopenjualan
	,msdyn_companycode
FROM (
	SELECT  
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.* 
        , b.msdyn_companycode
    FROM CRM_xts_newvehicledeliveryorder a WITH(NOLOCK)
	LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
	WHERE xts_newvehicledeliveryorderid = @Id
) VWI_CRM_xts_newvehicledeliveryorder 
