SELECT 
	ROW_NUMBER() OVER (Order by 0) AS IDRow
      ,company
      ,businessunitcode
      ,organizer
      ,prioritycodename
      ,versionnumber
      ,createdon
      ,modifiedonbehalfbyyominame
      ,xts_servicetypename
      ,xts_totallaborcost
      ,xts_reasonidname
      ,statuscodename
      ,isregularactivityname
      ,traversedpath
      ,activityid
      ,from
      ,owneridtype
      ,xts_billabletype
      ,customers
      ,createdonbehalfby
      ,deliverylastattemptedon
      ,siteidname
      ,partners
      ,onholdtime
      ,xts_businessunitidname
      ,xts_reasonid
      ,regardingobjectidyominame
      ,owneridname
      ,prioritycode
      ,xts_isfromwoquotename
      ,overriddencreatedon
      ,xts_nonbillabletype
      ,scheduledstart
      ,createdonbehalfbyyominame
      ,subscriptionid
      ,isbilled
      ,exchangerate
      ,subcategory
      ,owningteam
      ,deliveryprioritycode
      ,xts_totallaborcost_base
      ,regardingobjectid
      ,statecode
      ,seriesid
      ,subject
      ,siteid
      ,bcc
      ,xts_costcenterid
      ,xts_isfromwoquote
      ,xts_businessunitid
      ,instancetypecode
      ,modifiedonbehalfby
      ,stageid
      ,community
      ,xts_locking
      ,xts_servicetype
      ,sendermailboxid
      ,deliveryprioritycodename
      ,activitytypecodename
      ,regardingobjectidname
      ,activityadditionalparams
      ,createdonbehalfbyname
      ,xts_billablename
      ,actualstart
      ,xts_maindealerinvoicegroupname
      ,resources
      ,activitytypecode
      ,timezoneruleversionnumber
      ,instancetypecodename
      ,utcconversiontimezonecode
      ,slaid
      ,ownerid
      ,isworkflowcreated
      ,importsequencenumber
      ,owneridyominame
      ,scheduleddurationminutes
      ,category
      ,processid
      ,sortdate
      ,description
      ,modifiedon
      ,xts_billabletypename
      ,location
      ,createdbyname
      ,regardingobjecttypecode
      ,ismapiprivatename
      ,modifiedonbehalfbyname
      ,ismapiprivate
      ,isworkflowcreatedname
      ,senton
      ,lastonholdtime
      ,xts_freecouponnumber
      ,exchangeweblink
      ,requiredattendees
      ,leftvoicemail
      ,xts_nonbillabletypename
      ,xts_billable
      ,sendermailboxidname
      ,transactioncurrencyid
      ,slainvokedid
      ,createdby
      ,modifiedby
      ,isalldayevent
      ,exchangeitemid
      ,serviceid
      ,createdbyyominame
      ,owninguser
      ,transactioncurrencyidname
      ,xts_locationidname
      ,actualend
      ,owningbusinessunit
      ,xts_locationid
      ,isalldayeventname
      ,modifiedbyyominame
      ,cc
      ,to
      ,isregularactivity
      ,serviceidname
      ,isbilledname
      ,slainvokedidname
      ,scheduledend
      ,statuscode
      ,modifiedbyname
      ,xts_maindealerinvoicegroup
      ,xts_costcenteridname
      ,optionalattendees
      ,actualdurationminutes
      ,postponeactivityprocessinguntil
      ,leftvoicemailname
      ,statecodename
      ,slaname
      ,communityname
      --,msdyn_organizationalunitid
      --,msdyn_organizationalunitidname
      ,msdyn_companycode
from (
	SELECT  
		  b.ktb_bucompany company
		, b.ktb_dealercode businessunitcode
		, a.* 
		, b.msdyn_companycode
	FROM [CRM_serviceappointment] a with(nolock)
	INNER JOIN CRM_businessunit b with(nolock)
	ON b.businessunitid = a.xts_businessunitid
	WHERE serviceappointmentid = @Id
) VWI_CRM_serviceappointment
