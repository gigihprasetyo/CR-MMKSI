SELECT 
	    ROW_NUMBER() OVER (ORDER BY (Select 0) ) AS IDRow
      ,company
      ,businessunitcode
      ,xts_appointmenttypename
      ,prioritycodename
      ,versionnumber
      ,createdon
      ,modifiedonbehalfbyyominame
      ,xts_regardingpersoninchargeidname
      ,originalstartdate
      ,xts_referenceid
      ,xts_referencenumberlookuptype
      ,attachmentcount
      ,statuscodename
      ,isregularactivityname
      ,activityid
      ,xts_referenceglobalserviceidname
      ,xto_activityrating
      ,owneridtype
      ,isdraftname
      ,xts_personinchargeid
      ,createdonbehalfby
      ,xts_mobilephone
      ,onholdtime
      ,xts_businessunitidname
      ,xts_vehiclemodelidname
      ,regardingobjectidyominame
      ,owneridname
      ,prioritycode
      ,overriddencreatedon
      ,xts_vehiclemodelid
      ,xts_referenceusedvehicleidname
      ,xts_referenceglobalserviceid
      ,scheduledstart
      ,createdonbehalfbyyominame
      ,subscriptionid
      ,isbilled
      ,exchangerate
      ,isregularactivity
      ,subcategory
      ,owningteam
      ,activityadditionalparams
      ,xts_vehiclebrandid
      ,xts_productidname
      ,regardingobjectid
      ,statecode
      ,seriesid
      ,timezoneruleversionnumber
      ,attachmenterrors
      ,xts_businessunitid
      ,xts_productexteriorcoloridname
      ,modifiedonbehalfby
      ,xts_referencenumberlookupname
      ,xts_locking
      ,xts_email
      ,attachmenterrorsname
      ,xts_manufactureridname
      ,activitytypecodename
      ,regardingobjectidname
      ,xto_salespersonid
      ,traversedpath
      ,createdonbehalfbyname
      ,actualstart
      ,xts_productexteriorcolorid
      ,safedescription
      ,isbilledname
      ,activitytypecode
      ,utcconversiontimezonecode
      ,instancetypecodename
      ,xts_vehiclebrandidname
      ,organizer
      ,slainvokedid
      ,ownerid
      ,isworkflowcreated
      ,importsequencenumber
      ,owneridyominame
      ,scheduleddurationminutes
      ,category
      ,isunsafe
      ,xts_personinchargeidname
      ,processid
      ,sortdate
      ,description
      ,modifiedon
      ,isdraft
      ,location
      ,createdbyname
      ,globalobjectid
      ,instancetypecode
      ,ismapiprivatename
      ,modifiedonbehalfbyname
      ,ismapiprivate
      ,isworkflowcreatedname
      ,requiredattendees
      ,xts_vehicleidentificationidname
      ,lastonholdtime
      ,stageid
      ,optionalattendees
      ,xts_appointmenttype
      ,xto_activityresult
      ,xts_productid
      ,transactioncurrencyid
      ,slaid
      ,createdby
      ,modifiedby
      ,isalldayevent
      ,serviceid
      ,createdbyyominame
      ,owninguser
      ,transactioncurrencyidname
      ,xto_activityresultname
      ,actualend
      ,owningbusinessunit
      ,xts_vehicleidentificationid
      ,isalldayeventname
      ,modifiedbyyominame
      ,xts_regardingpersoninchargeid
      ,regardingobjecttypecode
      ,xto_salespersonidname
      ,slainvokedidname
      ,scheduledend
      ,statuscode
      ,modifiedbyname
      ,xts_referenceusedvehicleid
      ,modifiedfieldsmask
      ,outlookownerapptid
      ,actualdurationminutes
      ,xts_manufacturerid
      ,xts_referenceidname
      ,subject
      ,xto_activityratingname
      ,statecodename
      ,slaname
      ,msdyn_companycode
FROM (
	select    
		 b.ktb_bucompany company  
		 ,b.ktb_dealercode businessunitcode  
		 ,a.*
		 ,b.msdyn_companycode 
	from CRM_appointment a WITH(NOLOCK)
	JOIN CRM_businessunit b WITH(NOLOCK) 
	ON b.businessunitid = a.xts_businessunitid
	where appointmentid = @Id
) VWI_CRM_appointment 