SELECT 
    ROW_NUMBER() OVER (ORDER BY (SELECT 0)) AS IDRow
    , company
    , businessunitcode
    , xts_startdate
    , xts_titleregistrationfee
    , versionnumber
    , xts_accessorytotaldiscount_base
    , createdon
    , xts_ontheroadprice
    , xts_productconfigurationid
    , xts_consumptiontax1id
    , statuscodename
    , xts_productinteriorcolorid
    , xts_mandatorycolorname
    , xts_vehiclediscount
    , modifiedbyyominame
    , owneridtype
    , xts_gradenumber
    , modifiedonbehalfbyyominame
    , xts_productstyleidname
    , owneridname
    , xts_defaultbrand
    , overriddencreatedon
    , xts_maximumdiscountamount_base
    , xts_netsalesprice_base
    , xts_gradeid
    , createdonbehalfbyyominame
    , modifiedonbehalfby
    , exchangerate
    , createdby
    , xts_consumptiontax2id
    , owningteam
    , modifiedonbehalfbyname
    , xts_mandatoryaccessoryname
    , xts_productidname
    , xts_accessorysalesprice_base
    , statecode
    , timezoneruleversionnumber
    , xts_netsalesprice
    , xts_productstyleid
    , xts_locking
    , xts_totalsalesprice
    , xts_mandatorycolor
    , xts_consumptiontax1idname
    , xts_baseprice_base
    , xts_consumptiontax2idname
    , xts_productexteriorcolorid
    , xts_recommendedproduct
    , xts_accessorysalesprice
    , xts_totalsalesprice_base
    , xts_maximumdiscountamount
    , utcconversiontimezonecode
    , xts_specialcolorprice
    , xts_titleregistrationfee_base
    , ownerid
    , modifiedon
    , importsequencenumber
    , owneridyominame
    , modifiedby
    , xts_pkcombinationkey
    , createdbyname
    , xts_businessunitid
    , createdonbehalfbyname
    , xts_offtheroadprice
    , xts_productexteriorcoloridname
    , xts_productconfigurationidname
    , xts_specialcolorprice_base
    , xts_gradeidname
    , xts_enddate
    , xts_productid
    , transactioncurrencyid
    , createdonbehalfby
    , xts_baseprice
    , xts_mandatoryaccessory
    , xts_vehiclediscount_base
    , createdbyyominame
    , owninguser
    , transactioncurrencyidname
    , xts_offtheroadprice_base
    , xts_recommendedproductid
    , xts_ontheroadprice_base
    , xts_productinteriorcoloridname
    , xts_accessorytotaldiscount
    , statuscode
    , modifiedbyname
    , xts_defaultbrandgeneration
    , statecodename
    , xts_businessunitidname
    , owningbusinessunit
    , msdyn_companycode
FROM (
	SELECT 
        b.ktb_bucompany company,
        b.ktb_dealercode businessunitcode
        , a.* 
        , b.msdyn_companycode
    FROM CRM_xts_recommendedproduct a WITH(NOLOCK)
    LEFT JOIN CRM_businessunit b WITH(NOLOCK) 
    ON b.businessunitid = a.xts_businessunitid
    WHERE xts_recommendedproductid = @Id
) as VWI_CRM_xts_recommendedproduct  
