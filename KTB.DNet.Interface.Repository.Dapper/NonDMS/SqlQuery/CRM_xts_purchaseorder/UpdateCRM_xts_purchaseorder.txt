UPDATE CRM_xts_purchaseorder
	SET 
	bsi_isfactoring = ISNULL(@bsi_isfactoring, bsi_isfactoring),
	bsi_isfactoringname = ISNULL(@bsi_isfactoringname, bsi_isfactoringname),
	--createdby = ISNULL((CASE WHEN @createdby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @createdby END), createdby),
	createdbyname = ISNULL(@createdbyname, createdbyname),
	createdbyyominame = ISNULL(@createdbyyominame, createdbyyominame),
	--createdon = ISNULL(@createdon, createdon),
	createdonbehalfby = ISNULL((CASE WHEN @createdonbehalfby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @createdonbehalfby END), createdonbehalfby),
	createdonbehalfbyname = ISNULL(@createdonbehalfbyname, createdonbehalfbyname),
	createdonbehalfbyyominame = ISNULL(@createdonbehalfbyyominame, createdonbehalfbyyominame),
	DealerCode = ISNULL(@DealerCode, DealerCode),
	exchangerate = ISNULL(@exchangerate, exchangerate),
	importsequencenumber = ISNULL(@importsequencenumber, importsequencenumber),
	ktb_dealerpknumber = ISNULL(@ktb_dealerpknumber, ktb_dealerpknumber),
	ktb_dnetsalesordertype = ISNULL(@ktb_dnetsalesordertype, ktb_dnetsalesordertype),
	ktb_dnetsalesordertypename = ISNULL(@ktb_dnetsalesordertypename, ktb_dnetsalesordertypename),
	ktb_documenttype = ISNULL(@ktb_documenttype, ktb_documenttype),
	ktb_documenttypename = ISNULL(@ktb_documenttypename, ktb_documenttypename),
	ktb_duedate = ISNULL(@ktb_duedate, ktb_duedate),
	ktb_etd = ISNULL(@ktb_etd, ktb_etd),
	ktb_identificationtype = ISNULL(@ktb_identificationtype, ktb_identificationtype),
	ktb_identificationtypename = ISNULL(@ktb_identificationtypename, ktb_identificationtypename),
	ktb_interesttotalamount = ISNULL(@ktb_interesttotalamount, ktb_interesttotalamount),
	ktb_interesttotalamount_base = ISNULL(@ktb_interesttotalamount_base, ktb_interesttotalamount_base),
	ktb_interfacestatus = ISNULL(@ktb_interfacestatus, ktb_interfacestatus),
	ktb_interfacestatusname = ISNULL(@ktb_interfacestatusname, ktb_interfacestatusname),
	ktb_isbodypaint = ISNULL(@ktb_isbodypaint, ktb_isbodypaint),
	ktb_isbodypaintname = ISNULL(@ktb_isbodypaintname, ktb_isbodypaintname),
	ktb_isinterfaced = ISNULL(@ktb_isinterfaced, ktb_isinterfaced),
	ktb_isinterfacedname = ISNULL(@ktb_isinterfacedname, ktb_isinterfacedname),
	ktb_landedcost = ISNULL(@ktb_landedcost, ktb_landedcost),
	ktb_landedcost_base = ISNULL(@ktb_landedcost_base, ktb_landedcost_base),
	ktb_methodofpaymentid = ISNULL((CASE WHEN @ktb_methodofpaymentid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @ktb_methodofpaymentid END), ktb_methodofpaymentid),
	ktb_methodofpaymentidname = ISNULL(@ktb_methodofpaymentidname, ktb_methodofpaymentidname),
	ktb_numberofinstallment = ISNULL(@ktb_numberofinstallment, ktb_numberofinstallment),
	ktb_orderconfirmationno = ISNULL(@ktb_orderconfirmationno, ktb_orderconfirmationno),
	ktb_orderno = ISNULL(@ktb_orderno, ktb_orderno),
	ktb_ordertype = ISNULL(@ktb_ordertype, ktb_ordertype),
	ktb_ordertypename = ISNULL(@ktb_ordertypename, ktb_ordertypename),
	ktb_pph22amount = ISNULL(@ktb_pph22amount, ktb_pph22amount),
	ktb_pph22amount_base = ISNULL(@ktb_pph22amount_base, ktb_pph22amount_base),
	ktb_purchaseorderno = ISNULL(@ktb_purchaseorderno, ktb_purchaseorderno),
	ktb_purchasepriority = ISNULL(@ktb_purchasepriority, ktb_purchasepriority),
	ktb_purchasepriorityname = ISNULL(@ktb_purchasepriorityname, ktb_purchasepriorityname),
	ktb_purchasetype = ISNULL(@ktb_purchasetype, ktb_purchasetype),
	ktb_purchasetypename = ISNULL(@ktb_purchasetypename, ktb_purchasetypename),
	ktb_redeemamount = ISNULL(@ktb_redeemamount, ktb_redeemamount),
	ktb_redeemamount_base = ISNULL(@ktb_redeemamount_base, ktb_redeemamount_base),
	ktb_salesorderdate = ISNULL(@ktb_salesorderdate, ktb_salesorderdate),
	ktb_salesorderid = ISNULL((CASE WHEN @ktb_salesorderid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @ktb_salesorderid END), ktb_salesorderid),
	ktb_salesorderidname = ISNULL(@ktb_salesorderidname, ktb_salesorderidname),
	ktb_salesorderno = ISNULL(@ktb_salesorderno, ktb_salesorderno),
	ktb_salesordertype = ISNULL(@ktb_salesordertype, ktb_salesordertype),
	ktb_salespersonid = ISNULL((CASE WHEN @ktb_salespersonid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @ktb_salespersonid END), ktb_salespersonid),
	ktb_salespersonidname = ISNULL(@ktb_salespersonidname, ktb_salespersonidname),
	ktb_say = ISNULL(@ktb_say, ktb_say),
	ktb_vehicletotalamount = ISNULL(@ktb_vehicletotalamount, ktb_vehicletotalamount),
	ktb_vehicletotalamount_base = ISNULL(@ktb_vehicletotalamount_base, ktb_vehicletotalamount_base),
	modifiedby = ISNULL((CASE WHEN @modifiedby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @modifiedby END), modifiedby),
	modifiedbyname = ISNULL(@modifiedbyname, modifiedbyname),
	modifiedbyyominame = ISNULL(@modifiedbyyominame, modifiedbyyominame),
	modifiedon = ISNULL(@modifiedon, modifiedon),
	modifiedonbehalfby = ISNULL((CASE WHEN @modifiedonbehalfby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @modifiedonbehalfby END), modifiedonbehalfby),
	modifiedonbehalfbyname = ISNULL(@modifiedonbehalfbyname, modifiedonbehalfbyname),
	modifiedonbehalfbyyominame = ISNULL(@modifiedonbehalfbyyominame, modifiedonbehalfbyyominame),
	overriddencreatedon = ISNULL(@overriddencreatedon, overriddencreatedon),
	ownerid = ISNULL((CASE WHEN @ownerid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @ownerid END), ownerid),
	owneridname = ISNULL(@owneridname, owneridname),
	owneridtype = ISNULL(@owneridtype, owneridtype),
	owneridyominame = ISNULL(@owneridyominame, owneridyominame),
	owningbusinessunit = ISNULL((CASE WHEN @owningbusinessunit = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @owningbusinessunit END), owningbusinessunit),
	owningteam = ISNULL((CASE WHEN @owningteam = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @owningteam END), owningteam),
	owninguser = ISNULL((CASE WHEN @owninguser = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @owninguser END), owninguser),
	processid = ISNULL((CASE WHEN @processid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @processid END), processid),
	RowStatus = ISNULL(@RowStatus, RowStatus),
	SourceType = ISNULL(@SourceType, SourceType),
	stageid = ISNULL((CASE WHEN @stageid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @stageid END), stageid),
	statecode = ISNULL(@statecode, statecode),
	statecodename = ISNULL(@statecodename, statecodename),
	statuscode = ISNULL(@statuscode, statuscode),
	statuscodename = ISNULL(@statuscodename, statuscodename),
	timezoneruleversionnumber = ISNULL(@timezoneruleversionnumber, timezoneruleversionnumber),
	transactioncurrencyid = ISNULL((CASE WHEN @transactioncurrencyid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @transactioncurrencyid END), transactioncurrencyid),
	transactioncurrencyidname = ISNULL(@transactioncurrencyidname, transactioncurrencyidname),
	traversedpath = ISNULL(@traversedpath, traversedpath),
	utcconversiontimezonecode = ISNULL(@utcconversiontimezonecode, utcconversiontimezonecode),
	versionnumber = ISNULL(@versionnumber, versionnumber),
	xjp_idempotentmessage = ISNULL(@xjp_idempotentmessage, xjp_idempotentmessage),
	xts_address1 = ISNULL(@xts_address1, xts_address1),
	xts_address2 = ISNULL(@xts_address2, xts_address2),
	xts_address3 = ISNULL(@xts_address3, xts_address3),
	xts_address4 = ISNULL(@xts_address4, xts_address4),
	xts_allocationperiod = ISNULL(@xts_allocationperiod, xts_allocationperiod),
	xts_balance = ISNULL(@xts_balance, xts_balance),
	xts_balance_base = ISNULL(@xts_balance_base, xts_balance_base),
	xts_businessunitid = ISNULL((CASE WHEN @xts_businessunitid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_businessunitid END), xts_businessunitid),
	xts_businessunitidname = ISNULL(@xts_businessunitidname, xts_businessunitidname),
	xts_cityid = ISNULL((CASE WHEN @xts_cityid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_cityid END), xts_cityid),
	xts_cityidname = ISNULL(@xts_cityidname, xts_cityidname),
	xts_closereason = ISNULL(@xts_closereason, xts_closereason),
	xts_countryid = ISNULL((CASE WHEN @xts_countryid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_countryid END), xts_countryid),
	xts_countryidname = ISNULL(@xts_countryidname, xts_countryidname),
	xts_deliverymethod = ISNULL(@xts_deliverymethod, xts_deliverymethod),
	xts_deliverymethodname = ISNULL(@xts_deliverymethodname, xts_deliverymethodname),
	xts_description = ISNULL(@xts_description, xts_description),
	xts_downpayment = ISNULL(@xts_downpayment, xts_downpayment),
	xts_downpayment_base = ISNULL(@xts_downpayment_base, xts_downpayment_base),
	xts_downpaymentamountpaid = ISNULL(@xts_downpaymentamountpaid, xts_downpaymentamountpaid),
	xts_downpaymentamountpaid_base = ISNULL(@xts_downpaymentamountpaid_base, xts_downpaymentamountpaid_base),
	xts_downpaymentispaid = ISNULL(@xts_downpaymentispaid, xts_downpaymentispaid),
	xts_downpaymentispaidname = ISNULL(@xts_downpaymentispaidname, xts_downpaymentispaidname),
	xts_eventdata = ISNULL(@xts_eventdata, xts_eventdata),
	xts_eventdata2 = ISNULL(@xts_eventdata2, xts_eventdata2),
	xts_externaldocumentnumber = ISNULL(@xts_externaldocumentnumber, xts_externaldocumentnumber),
	xts_formsource = ISNULL(@xts_formsource, xts_formsource),
	xts_formsourcename = ISNULL(@xts_formsourcename, xts_formsourcename),
	xts_grandtotal = ISNULL(@xts_grandtotal, xts_grandtotal),
	xts_grandtotal_base = ISNULL(@xts_grandtotal_base, xts_grandtotal_base),
	xts_handling = ISNULL(@xts_handling, xts_handling),
	xts_handlingname = ISNULL(@xts_handlingname, xts_handlingname),
	xts_includetax = ISNULL(@xts_includetax, xts_includetax),
	xts_includetaxname = ISNULL(@xts_includetaxname, xts_includetaxname),
	xts_locking = ISNULL(@xts_locking, xts_locking),
	xts_newvehiclesalesorderid = ISNULL((CASE WHEN @xts_newvehiclesalesorderid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_newvehiclesalesorderid END), xts_newvehiclesalesorderid),
	xts_newvehiclesalesorderidname = ISNULL(@xts_newvehiclesalesorderidname, xts_newvehiclesalesorderidname),
	xts_parentbusinessunitid = ISNULL((CASE WHEN @xts_parentbusinessunitid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_parentbusinessunitid END), xts_parentbusinessunitid),
	xts_parentbusinessunitidname = ISNULL(@xts_parentbusinessunitidname, xts_parentbusinessunitidname),
	xts_partsforecastid = ISNULL((CASE WHEN @xts_partsforecastid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_partsforecastid END), xts_partsforecastid),
	xts_partsforecastidname = ISNULL(@xts_partsforecastidname, xts_partsforecastidname),
	xts_paymentgroup = ISNULL(@xts_paymentgroup, xts_paymentgroup),
	xts_paymentgroupname = ISNULL(@xts_paymentgroupname, xts_paymentgroupname),
	xts_personinchargeid = ISNULL((CASE WHEN @xts_personinchargeid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_personinchargeid END), xts_personinchargeid),
	xts_personinchargeidname = ISNULL(@xts_personinchargeidname, xts_personinchargeidname),
	xts_postalcode = ISNULL(@xts_postalcode, xts_postalcode),
	xts_priority = ISNULL(@xts_priority, xts_priority),
	xts_priorityname = ISNULL(@xts_priorityname, xts_priorityname),
	xts_provinceid = ISNULL((CASE WHEN @xts_provinceid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_provinceid END), xts_provinceid),
	xts_provinceidname = ISNULL(@xts_provinceidname, xts_provinceidname),
	xts_prpotypeid = ISNULL((CASE WHEN @xts_prpotypeid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_prpotypeid END), xts_prpotypeid),
	xts_prpotypeidname = ISNULL(@xts_prpotypeidname, xts_prpotypeidname),
	xts_purchaseordernumber = ISNULL(@xts_purchaseordernumber, xts_purchaseordernumber),
	xts_salesorderid = ISNULL((CASE WHEN @xts_salesorderid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_salesorderid END), xts_salesorderid),
	xts_salesorderidname = ISNULL(@xts_salesorderidname, xts_salesorderidname),
	xts_siteid = ISNULL((CASE WHEN @xts_siteid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_siteid END), xts_siteid),
	xts_siteidname = ISNULL(@xts_siteidname, xts_siteidname),
	xts_status = ISNULL(@xts_status, xts_status),
	xts_statusname = ISNULL(@xts_statusname, xts_statusname),
	xts_stockreferencenumber = ISNULL(@xts_stockreferencenumber, xts_stockreferencenumber),
	xts_taxable = ISNULL(@xts_taxable, xts_taxable),
	xts_taxablename = ISNULL(@xts_taxablename, xts_taxablename),
	xts_termsofpaymentdescription = ISNULL(@xts_termsofpaymentdescription, xts_termsofpaymentdescription),
	xts_termsofpaymentid = ISNULL((CASE WHEN @xts_termsofpaymentid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_termsofpaymentid END), xts_termsofpaymentid),
	xts_termsofpaymentidname = ISNULL(@xts_termsofpaymentidname, xts_termsofpaymentidname),
	xts_totalamountbeforediscount = ISNULL(@xts_totalamountbeforediscount, xts_totalamountbeforediscount),
	xts_totalamountbeforediscount_base = ISNULL(@xts_totalamountbeforediscount_base, xts_totalamountbeforediscount_base),
	xts_totalbaseamount = ISNULL(@xts_totalbaseamount, xts_totalbaseamount),
	xts_totalbaseamount_base = ISNULL(@xts_totalbaseamount_base, xts_totalbaseamount_base),
	xts_totalconsumptiontaxamount = ISNULL(@xts_totalconsumptiontaxamount, xts_totalconsumptiontaxamount),
	xts_totalconsumptiontaxamount_base = ISNULL(@xts_totalconsumptiontaxamount_base, xts_totalconsumptiontaxamount_base),
	xts_totaldiscountamount = ISNULL(@xts_totaldiscountamount, xts_totaldiscountamount),
	xts_totaldiscountamount_base = ISNULL(@xts_totaldiscountamount_base, xts_totaldiscountamount_base),
	xts_totalpaymentamount = ISNULL(@xts_totalpaymentamount, xts_totalpaymentamount),
	xts_totalpaymentamount_base = ISNULL(@xts_totalpaymentamount_base, xts_totalpaymentamount_base),
	xts_totaltitleregistrationfee = ISNULL(@xts_totaltitleregistrationfee, xts_totaltitleregistrationfee),
	xts_totaltitleregistrationfee_base = ISNULL(@xts_totaltitleregistrationfee_base, xts_totaltitleregistrationfee_base),
	xts_totalwithholdingtaxamount = ISNULL(@xts_totalwithholdingtaxamount, xts_totalwithholdingtaxamount),
	xts_totalwithholdingtaxamount_base = ISNULL(@xts_totalwithholdingtaxamount_base, xts_totalwithholdingtaxamount_base),
	xts_transactiondate = ISNULL(@xts_transactiondate, xts_transactiondate),
	xts_vendoraddress1 = ISNULL(@xts_vendoraddress1, xts_vendoraddress1),
	xts_vendoraddress2 = ISNULL(@xts_vendoraddress2, xts_vendoraddress2),
	xts_vendoraddress3 = ISNULL(@xts_vendoraddress3, xts_vendoraddress3),
	xts_vendoraddress4 = ISNULL(@xts_vendoraddress4, xts_vendoraddress4),
	xts_vendorcityid = ISNULL((CASE WHEN @xts_vendorcityid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_vendorcityid END), xts_vendorcityid),
	xts_vendorcityidname = ISNULL(@xts_vendorcityidname, xts_vendorcityidname),
	xts_vendorcountryid = ISNULL((CASE WHEN @xts_vendorcountryid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_vendorcountryid END), xts_vendorcountryid),
	xts_vendorcountryidname = ISNULL(@xts_vendorcountryidname, xts_vendorcountryidname),
	xts_vendordescription = ISNULL(@xts_vendordescription, xts_vendordescription),
	xts_vendorid = ISNULL((CASE WHEN @xts_vendorid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_vendorid END), xts_vendorid),
	xts_vendoridname = ISNULL(@xts_vendoridname, xts_vendoridname),
	xts_vendorpostalcode = ISNULL(@xts_vendorpostalcode, xts_vendorpostalcode),
	xts_vendorprovinceid = ISNULL((CASE WHEN @xts_vendorprovinceid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_vendorprovinceid END), xts_vendorprovinceid),
	xts_vendorprovinceidname = ISNULL(@xts_vendorprovinceidname, xts_vendorprovinceidname),
	xts_warehouseid = ISNULL((CASE WHEN @xts_warehouseid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_warehouseid END), xts_warehouseid),
	xts_warehouseidname = ISNULL(@xts_warehouseidname, xts_warehouseidname),
	xts_workorderid = ISNULL((CASE WHEN @xts_workorderid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_workorderid END), xts_workorderid),
	xts_workorderidname = ISNULL(@xts_workorderidname, xts_workorderidname)
WHERE xts_purchaseorderid = @xts_purchaseorderid