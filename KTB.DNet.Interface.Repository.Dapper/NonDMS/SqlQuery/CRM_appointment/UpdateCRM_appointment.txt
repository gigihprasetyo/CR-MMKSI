UPDATE CRM_appointment
	SET 
	activityadditionalparams = ISNULL(@activityadditionalparams, activityadditionalparams),
	activitytypecode = ISNULL(@activitytypecode, activitytypecode),
	activitytypecodename = ISNULL(@activitytypecodename, activitytypecodename),
	actualdurationminutes = ISNULL(@actualdurationminutes, actualdurationminutes),
	actualend = ISNULL(@actualend, actualend),
	actualstart = ISNULL(@actualstart, actualstart),
	attachmentcount = ISNULL(@attachmentcount, attachmentcount),
	attachmenterrors = ISNULL(@attachmenterrors, attachmenterrors),
	attachmenterrorsname = ISNULL(@attachmenterrorsname, attachmenterrorsname),
	category = ISNULL(@category, category),
	--createdby = ISNULL((CASE WHEN @createdby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @createdby END), createdby),
	createdbyname = ISNULL(@createdbyname, createdbyname),
	createdbyyominame = ISNULL(@createdbyyominame, createdbyyominame),
	--createdon = ISNULL(@createdon, createdon),
	createdonbehalfby = ISNULL((CASE WHEN @createdonbehalfby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @createdonbehalfby END), createdonbehalfby),
	createdonbehalfbyname = ISNULL(@createdonbehalfbyname, createdonbehalfbyname),
	createdonbehalfbyyominame = ISNULL(@createdonbehalfbyyominame, createdonbehalfbyyominame),
	DealerCode = ISNULL(@DealerCode, DealerCode),
	description = ISNULL(@description, description),
	exchangerate = ISNULL(@exchangerate, exchangerate),
	globalobjectid = ISNULL(@globalobjectid, globalobjectid),
	importsequencenumber = ISNULL(@importsequencenumber, importsequencenumber),
	instancetypecode = ISNULL(@instancetypecode, instancetypecode),
	instancetypecodename = ISNULL(@instancetypecodename, instancetypecodename),
	isalldayevent = ISNULL(@isalldayevent, isalldayevent),
	isalldayeventname = ISNULL(@isalldayeventname, isalldayeventname),
	isbilled = ISNULL(@isbilled, isbilled),
	isbilledname = ISNULL(@isbilledname, isbilledname),
	isdraft = ISNULL(@isdraft, isdraft),
	isdraftname = ISNULL(@isdraftname, isdraftname),
	ismapiprivate = ISNULL(@ismapiprivate, ismapiprivate),
	ismapiprivatename = ISNULL(@ismapiprivatename, ismapiprivatename),
	isregularactivity = ISNULL(@isregularactivity, isregularactivity),
	isregularactivityname = ISNULL(@isregularactivityname, isregularactivityname),
	isunsafe = ISNULL(@isunsafe, isunsafe),
	isworkflowcreated = ISNULL(@isworkflowcreated, isworkflowcreated),
	isworkflowcreatedname = ISNULL(@isworkflowcreatedname, isworkflowcreatedname),
	lastonholdtime = ISNULL(@lastonholdtime, lastonholdtime),
	location = ISNULL(@location, location),
	modifiedby = ISNULL((CASE WHEN @modifiedby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @modifiedby END), modifiedby),
	modifiedbyname = ISNULL(@modifiedbyname, modifiedbyname),
	modifiedbyyominame = ISNULL(@modifiedbyyominame, modifiedbyyominame),
	modifiedfieldsmask = ISNULL(@modifiedfieldsmask, modifiedfieldsmask),
	modifiedon = ISNULL(@modifiedon, modifiedon),
	modifiedonbehalfby = ISNULL((CASE WHEN @modifiedonbehalfby = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @modifiedonbehalfby END), modifiedonbehalfby),
	modifiedonbehalfbyname = ISNULL(@modifiedonbehalfbyname, modifiedonbehalfbyname),
	modifiedonbehalfbyyominame = ISNULL(@modifiedonbehalfbyyominame, modifiedonbehalfbyyominame),
	onholdtime = ISNULL(@onholdtime, onholdtime),
	optionalattendees = ISNULL(@optionalattendees, optionalattendees),
	organizer = ISNULL(@organizer, organizer),
	originalstartdate = ISNULL(@originalstartdate, originalstartdate),
	outlookownerapptid = ISNULL(@outlookownerapptid, outlookownerapptid),
	overriddencreatedon = ISNULL(@overriddencreatedon, overriddencreatedon),
	ownerid = ISNULL((CASE WHEN @ownerid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @ownerid END), ownerid),
	owneridname = ISNULL(@owneridname, owneridname),
	owneridtype = ISNULL(@owneridtype, owneridtype),
	owneridyominame = ISNULL(@owneridyominame, owneridyominame),
	owningbusinessunit = ISNULL((CASE WHEN @owningbusinessunit = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @owningbusinessunit END), owningbusinessunit),
	owningteam = ISNULL((CASE WHEN @owningteam = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @owningteam END), owningteam),
	owninguser = ISNULL((CASE WHEN @owninguser = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @owninguser END), owninguser),
	prioritycode = ISNULL(@prioritycode, prioritycode),
	prioritycodename = ISNULL(@prioritycodename, prioritycodename),
	processid = ISNULL((CASE WHEN @processid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @processid END), processid),
	regardingobjectid = ISNULL((CASE WHEN @regardingobjectid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @regardingobjectid END), regardingobjectid),
	regardingobjectidname = ISNULL(@regardingobjectidname, regardingobjectidname),
	regardingobjectidyominame = ISNULL(@regardingobjectidyominame, regardingobjectidyominame),
	regardingobjecttypecode = ISNULL(@regardingobjecttypecode, regardingobjecttypecode),
	requiredattendees = ISNULL(@requiredattendees, requiredattendees),
	RowStatus = ISNULL(@RowStatus, RowStatus),
	safedescription = ISNULL(@safedescription, safedescription),
	scheduleddurationminutes = ISNULL(@scheduleddurationminutes, scheduleddurationminutes),
	scheduledend = ISNULL(@scheduledend, scheduledend),
	scheduledstart = ISNULL(@scheduledstart, scheduledstart),
	seriesid = ISNULL((CASE WHEN @seriesid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @seriesid END), seriesid),
	serviceid = ISNULL((CASE WHEN @serviceid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @serviceid END), serviceid),
	slaid = ISNULL((CASE WHEN @slaid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @slaid END), slaid),
	slainvokedid = ISNULL((CASE WHEN @slainvokedid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @slainvokedid END), slainvokedid),
	slainvokedidname = ISNULL(@slainvokedidname, slainvokedidname),
	slaname = ISNULL(@slaname, slaname),
	sortdate = ISNULL(@sortdate, sortdate),
	SourceType = ISNULL(@SourceType, SourceType),
	stageid = ISNULL((CASE WHEN @stageid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @stageid END), stageid),
	statecode = ISNULL(@statecode, statecode),
	statecodename = ISNULL(@statecodename, statecodename),
	statuscode = ISNULL(@statuscode, statuscode),
	statuscodename = ISNULL(@statuscodename, statuscodename),
	subcategory = ISNULL(@subcategory, subcategory),
	subject = ISNULL(@subject, subject),
	subscriptionid = ISNULL((CASE WHEN @subscriptionid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @subscriptionid END), subscriptionid),
	timezoneruleversionnumber = ISNULL(@timezoneruleversionnumber, timezoneruleversionnumber),
	transactioncurrencyid = ISNULL((CASE WHEN @transactioncurrencyid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @transactioncurrencyid END), transactioncurrencyid),
	transactioncurrencyidname = ISNULL(@transactioncurrencyidname, transactioncurrencyidname),
	traversedpath = ISNULL(@traversedpath, traversedpath),
	utcconversiontimezonecode = ISNULL(@utcconversiontimezonecode, utcconversiontimezonecode),
	versionnumber = ISNULL(@versionnumber, versionnumber),
	xto_activityrating = ISNULL(@xto_activityrating, xto_activityrating),
	xto_activityratingname = ISNULL(@xto_activityratingname, xto_activityratingname),
	xto_activityresult = ISNULL(@xto_activityresult, xto_activityresult),
	xto_activityresultname = ISNULL(@xto_activityresultname, xto_activityresultname),
	xto_salespersonid = ISNULL((CASE WHEN @xto_salespersonid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xto_salespersonid END), xto_salespersonid),
	xto_salespersonidname = ISNULL(@xto_salespersonidname, xto_salespersonidname),
	xts_appointmenttype = ISNULL(@xts_appointmenttype, xts_appointmenttype),
	xts_appointmenttypename = ISNULL(@xts_appointmenttypename, xts_appointmenttypename),
	xts_businessunitid = ISNULL((CASE WHEN @xts_businessunitid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_businessunitid END), xts_businessunitid),
	xts_businessunitidname = ISNULL(@xts_businessunitidname, xts_businessunitidname),
	xts_email = ISNULL(@xts_email, xts_email),
	xts_locking = ISNULL(@xts_locking, xts_locking),
	xts_manufacturerid = ISNULL((CASE WHEN @xts_manufacturerid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_manufacturerid END), xts_manufacturerid),
	xts_manufactureridname = ISNULL(@xts_manufactureridname, xts_manufactureridname),
	xts_mobilephone = ISNULL(@xts_mobilephone, xts_mobilephone),
	xts_personinchargeid = ISNULL((CASE WHEN @xts_personinchargeid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_personinchargeid END), xts_personinchargeid),
	xts_personinchargeidname = ISNULL(@xts_personinchargeidname, xts_personinchargeidname),
	xts_productexteriorcolorid = ISNULL((CASE WHEN @xts_productexteriorcolorid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_productexteriorcolorid END), xts_productexteriorcolorid),
	xts_productexteriorcoloridname = ISNULL(@xts_productexteriorcoloridname, xts_productexteriorcoloridname),
	xts_productid = ISNULL((CASE WHEN @xts_productid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_productid END), xts_productid),
	xts_productidname = ISNULL(@xts_productidname, xts_productidname),
	xts_referenceglobalserviceid = ISNULL((CASE WHEN @xts_referenceglobalserviceid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_referenceglobalserviceid END), xts_referenceglobalserviceid),
	xts_referenceglobalserviceidname = ISNULL(@xts_referenceglobalserviceidname, xts_referenceglobalserviceidname),
	xts_referenceid = ISNULL((CASE WHEN @xts_referenceid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_referenceid END), xts_referenceid),
	xts_referenceidname = ISNULL(@xts_referenceidname, xts_referenceidname),
	xts_referencenumberlookupname = ISNULL(@xts_referencenumberlookupname, xts_referencenumberlookupname),
	xts_referencenumberlookuptype = ISNULL(@xts_referencenumberlookuptype, xts_referencenumberlookuptype),
	xts_referenceusedvehicleid = ISNULL((CASE WHEN @xts_referenceusedvehicleid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_referenceusedvehicleid END), xts_referenceusedvehicleid),
	xts_referenceusedvehicleidname = ISNULL(@xts_referenceusedvehicleidname, xts_referenceusedvehicleidname),
	xts_regardingpersoninchargeid = ISNULL((CASE WHEN @xts_regardingpersoninchargeid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_regardingpersoninchargeid END), xts_regardingpersoninchargeid),
	xts_regardingpersoninchargeidname = ISNULL(@xts_regardingpersoninchargeidname, xts_regardingpersoninchargeidname),
	xts_vehiclebrandid = ISNULL((CASE WHEN @xts_vehiclebrandid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_vehiclebrandid END), xts_vehiclebrandid),
	xts_vehiclebrandidname = ISNULL(@xts_vehiclebrandidname, xts_vehiclebrandidname),
	xts_vehicleidentificationid = ISNULL((CASE WHEN @xts_vehicleidentificationid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_vehicleidentificationid END), xts_vehicleidentificationid),
	xts_vehicleidentificationidname = ISNULL(@xts_vehicleidentificationidname, xts_vehicleidentificationidname),
	xts_vehiclemodelid = ISNULL((CASE WHEN @xts_vehiclemodelid = cast(cast(0 as binary) as uniqueidentifier) THEN NULL ELSE @xts_vehiclemodelid END), xts_vehiclemodelid),
	xts_vehiclemodelidname = ISNULL(@xts_vehiclemodelidname, xts_vehiclemodelidname)
WHERE activityid = @activityid